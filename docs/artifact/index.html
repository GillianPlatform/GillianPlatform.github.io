<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus">
<script src="/scripts/fetchCosette.js"></script>

<title data-react-helmet="true">PLDI-2020-Artifact | Gillian</title>

<meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"><meta data-react-helmet="true" property="og:title" content="Gillian"><meta data-react-helmet="true" name="twitter:card" content="summary"><meta data-react-helmet="true" name="description" content="# Warm-Up"><meta data-react-helmet="true" property="og:description" content="# Warm-Up"><meta data-react-helmet="true" property="og:url" content="https://GillianPlatform.github.io/docs/artifact">

<link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico">


<link rel="stylesheet" href="/styles.7b4c5617.css">


<link rel="preload" href="/styles.6ee02291.js" as="script">

<link rel="preload" href="/runtime~main.f9559c41.js" as="script">

<link rel="preload" href="/main.88bc4ab7.js" as="script">

<link rel="preload" href="/1.2e06b5bd.js" as="script">

<link rel="preload" href="/2.891776eb.js" as="script">

<link rel="preload" href="/29.e21bd2d3.js" as="script">

<link rel="preload" href="/20ac7829.f548c11f.js" as="script">

<link rel="preload" href="/17896441.18bb5f40.js" as="script">

<link rel="preload" href="/20d095a8.2c797393.js" as="script">

</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo" src="/img/logo_full_white.svg" alt="Gillian logo, by Valentin Magnat"></a><a class="navbar__item navbar__link" href="/docs/start">Docs</a><a class="navbar__item navbar__link" href="/docs/js/intro">Gillian-JS</a><a class="navbar__item navbar__link" href="/docs/c/intro">Gillian-C</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/try">Try</a><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://github.com/GillianPlatform/Gillian">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo" src="/img/logo_full_white.svg" alt="Gillian logo, by Valentin Magnat"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/start">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/js/intro">Gillian-JS</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/c/intro">Gillian-C</a></li><li class="menu__list-item"><a class="menu__link" href="/try">Try</a></li><li class="menu__list-item"><a class="menu__link" target="_blank" rel="noopener noreferrer" href="https://github.com/GillianPlatform/Gillian">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><main class="docMainContainer_FFX1"><div class="padding-vert--lg"><div class="container"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">PLDI-2020-Artifact</h1></header><div class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="warm-up"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#warm-up" title="Direct link to heading">#</a>Warm-Up</h1><ol><li>This document is, in fact, an <code>.md</code> document. We encourage you to open it in an <code>.md</code> viewer, such as <a href="https://typora.io/#download">Typora</a> to have the proper experience. It is also available online <a href="https://gillianplatform.github.io/docs/artifact">here</a>.</li><li>The virtual machine you will download is directly in <code>.ova</code> format. Zipping it does not reduce its size, which is ~6Gb. Therefore, your download may take some time.</li><li>We are hosting the virtual machine at an Imperial Box server. We are not keeping track of who is accessing it.</li><li>Gillian comes with an accompanying <a href="https://gillianplatform.github.io/">website</a> and <a href="https://github.com/GillianPlatform/Gillian/tree/PLDI20">GitHub repository</a>. Feel free to explore these as well. They are both in flux, but the provided GitHub link is to a tagged release corresponding to the VM.</li></ol><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="getting-started"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#getting-started" title="Direct link to heading">#</a>Getting Started</h1><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="downloading-and-starting-up-the-vm"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#downloading-and-starting-up-the-vm" title="Direct link to heading">#</a>Downloading and starting up the VM</h2><p>We provide the artifact in the form of a VirtualBox <code>.ova</code> file, which can be downloaded from <a href="https://imperialcollegelondon.app.box.com/v/gillian-pldi-20">here</a>. Its MD5 hash is <code>5fa97885f75dec9b33cb21ee788a0d48</code>.</p><p>The VM was created using VirtualBox (Version 6.0.18 r136238 (Qt5.6.3), downloadable from <a href="https://www.virtualbox.org/wiki/Download_Old_Builds_6_0">here</a>.
You can import the VM by clicking on <code>File</code> and then on <code>Import Appliance</code>. There, navigate to and select the <code>.ova</code> file that you downloaded.</p><p>The operating system of the VM is Ubuntu 19.10 Eoan Ermine and the VM already has Guest Additions installed. The settings of the VM can be changed by right-clicking on it in the VM list and then left-clicking on <code>Settings</code> in the drop-down menu that appears. The relevant settings are:</p><ul><li>System<ul><li>Base Memory: 4096 MB (go for more if your system can support it)</li><li>Processor(s): 4 (go for more if your system can support it)</li><li>Enable PAE/NX: On</li><li>Enable Nested Paging: On</li></ul></li><li>Display<ul><li>Video Memory: 128 MB</li><li>Enable 3D Acceleration: On</li></ul></li></ul><p>They are set by default, and if you do not want to change them, you can just start the VM. The master password you can use for any and all authentication inside the VM is: <code>osboxes.org</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="basic-testing"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#basic-testing" title="Direct link to heading">#</a>Basic testing</h2><p>Open the terminal by pressing CTRL+ALT+T or by clicking on <code>Show Applications</code> in the bottom left corner, typing in <code>Terminal</code>, and clicking on the terminal icon. Once in the terminal, type <code>cd Gillian</code> to get to the main Gillian folder (<code>~/Gillian</code>).</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="rebuilding-gillian"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#rebuilding-gillian" title="Direct link to heading">#</a>Rebuilding Gillian</h3><p>To rebuild Gillian, execute the following commands:</p><ol><li><code>rm -rf _build/ _esy/</code>                        (removes previous build information)</li><li><code>esy</code>                                         (has to be run from the root folder, compiles the project)</li><li><code>esy init:env</code>                                (initialises testing folders for Gillian-JS and Gillian-C)</li></ol><p>This should take between one and two minutes in total.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="testing-gillian-js-against-a-bit-of-the-test262-official-javascript-test-suite"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#testing-gillian-js-against-a-bit-of-the-test262-official-javascript-test-suite" title="Direct link to heading">#</a>Testing Gillian-JS against a bit of the Test262 official JavaScript test suite</h3><p>From the main Gillian folder, execute</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-bash codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">esy x gillian-js test262 </span><span class="token punctuation" style="color:rgb(212, 212, 212)">..</span><span class="token plain">/test262/test/built-ins/Number/</span></div></code></pre></div><p>At the end of the output, you should see the following lines:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">Test Suites: 1 failed, 9 skipped, 8 passed, 18 total</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Tests:       3 failed, 147 skipped, 144 passed, 294 total</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Time:        [TIME] (for us, it was ~14s)</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">ALL FAILURES:</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">../test262/test/built-ins/Number/S9.3.1_A3_T1.js</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">../test262/test/built-ins/Number/S9.3.1_A3_T2.js</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">../test262/test/built-ins/Number/S9.3.1_A2.js</span></div></code></pre></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="symbolically-testing-a-part-of-bucketsjs-using-gillian-js"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#symbolically-testing-a-part-of-bucketsjs-using-gillian-js" title="Direct link to heading">#</a>Symbolically testing a part of Buckets.js using Gillian-JS</h3><p>From the main Gillian folder, execute</p><ol><li><code>cd Gillian-JS/environment/</code>                              (this is where all Gillian-JS symbolic testing should happen)</li><li><code>./testCosetteFolder.sh Examples/Cosette/Buckets/bstree/</code> (runs the symbolic tests for the binary search trees of Buckets.js)</li></ol><p>The testing should also take ~20 seconds. This time may vary, as the testing is performed using multiple threads. Eleven tests should be executed, starting from <code>Examples/Cosette/Buckets/bstree/bstree10.js</code> and finishing with <code>Examples/Cosette/Buckets/bstree/bstree9.js</code>. After each test, the test time will be printed. There should be no other output.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="symbolically-testing-a-part-of-collections-c-using-gillian-c"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#symbolically-testing-a-part-of-collections-c-using-gillian-c" title="Direct link to heading">#</a>Symbolically testing a part of Collections-C using Gillian-C</h3><p>From the main Gillian folder, execute</p><p><code>./Gillian-C/environment/testFolder.sh ../collections-c/for-gillian/deque</code> (runs the symbolic tests for the deque of Collections-C)</p><p>The testing should take ~10 seconds, and the output should be as for Buckets.js, test name followed by test execution time, with 34 tests run, starting from <code>collections-c/for-gillian/deque/deque_test_addAt1.c</code> and finishing with <code>collections-c/for-gillian/deque/deque_test_zipIterReplace.c</code>.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="step-by-step-instructions"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#step-by-step-instructions" title="Direct link to heading">#</a>Step-By-Step Instructions</h1><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="gillian-js-section-41"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#gillian-js-section-41" title="Direct link to heading">#</a>Gillian-JS (Section 4.1)</h2><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></div>info</h5></div><div class="admonition-content"><p>Folders marked with the (❌PLDI20) annotation are out of scope for this submission.</p></div></div><p><code>Gillian-JS</code> is the instantiation of Gillian to JavaScript (ECMAScript 5 Strict). It can be found in the <code>Gillian-JS</code> folder of the repository. Its implementation consists of the following:</p><ul><li><strong>Gillian-JS</strong><ul><li><code>bin</code>: Source of the <code>gillian-js</code> executable.</li><li><code>environment</code>: Execution environment, not part of the repository, created using <code>esy init:env</code>. It contains useful scripts for testing Gillian-JS, and examples are copied in it so that they can be safely modified.</li><li><code>examples</code>: Various examples.<ul><li><code>Fantine</code>: Bi-abduction examples (❌PLDI20).</li><li><code>Cosette</code>: Symbolic testing examples.<ul><li><code>buckets</code>: Tests for the Buckets.js library.</li><li><code>case_studies</code>: Data structures used for initial evaluation (not reported).</li></ul></li><li><code>JaVerT</code>: Verification examples (❌PLDI20).</li></ul></li><li><code>lib</code>: The core of Gillian-JS.<ul><li><code>compiler</code>: The JS-2-GIL compiler.</li><li><code>JSIL</code>: Syntax of JSIL and related constructs.</li><li><code>JSLogic</code>: Verification-related constructs (assertions, predicates, specifications, etc.) (❌PLDI20).</li><li><code>parsing</code>: JSIL parsing (programs, annotations, etc.).</li><li><code>semantics</code>: Implementation of concrete and symbolic memory models.<ul><li><code>CObject.ml</code>: Concrete objects.</li><li><code>CHeap.ml</code>: Concrete heaps.</li><li><code>JSILCMemory.ml</code>: Concrete memory.</li><li><code>SFVL.ml</code>: Symbolic field-value lists.</li><li><code>SHeap.ml</code>: Symbolic heaps.</li><li><code>JSILSMemory.ml</code>: Symbolic memory.</li></ul></li><li><code>test262</code>: Bulk testing for the Test262 test suite.</li><li><code>utils</code>: Various utilities (configuration, I/O, etc.).</li></ul></li><li><code>runtime</code>: JS-2-GIL compiler runtime (JSIL implementations of JavaScript internal and built-in functions).</li><li><code>scripts</code>: Various scripts used for setting up the environment and running the analyses.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="coverage-of-js-2-gil"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#coverage-of-js-2-gil" title="Direct link to heading">#</a>Coverage of JS-2-GIL</h3><p>JS-2-GIL is a compiler from <a href="https://www.ecma-international.org/ecma-262/5.1/">ECMAScript ES5 Strict</a> to GIL. JS-2-GIL has broad coverage. It supports the entire core (chapters 8-14 of the standard), with the exception of the <code>RegExp</code> literal, as well as all of the JavaScript built-in libraries/functionalities except the following:</p><ul><li><code>Date</code>, <code>RegExp</code>, <code>JSON</code></li><li><code>Number.prototype.toFixed</code></li><li><code>String.fromCharCode</code></li><li><code>charCodeAt</code>, <code>localeCompare</code>, <code>match</code>, <code>replace</code>, <code>search</code>, <code>split</code>, <code>trim</code>, <code>toLocaleLowerCase</code>, <code>toLocaleUpperCase</code>, <code>toLowerCase</code>, <code>toUpperCase</code> (in <code>String.prototype</code>)</li><li><code>decodeURI</code>, <code>decodeURIComponent</code>, <code>encodeURI</code>, <code>encodeURIComponent</code>, <code>parseInt</code>, <code>parseFloat</code> (in the global object)</li></ul><p>Additionally, indirect <code>eval</code> is not supported, as it is meant to be executed as non-strict code. Furthermore, all <code>Function</code> constructor code runs as strict-mode code.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="correctness-of-js-2-gil"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#correctness-of-js-2-gil" title="Direct link to heading">#</a>Correctness of JS-2-GIL</h3><p>The JS-2-GIL compiler can be split into two compilers: JS-2-JSIL, which compiles JavaScript to JSIL, the intermediate representation that we have used in [JaVerT]/[Cosette]/[JaVerT 2.0] (references at end of document); and JSIL-2-GIL, the compiler from JSIL to GIL, the intermediate representation of Gillian.</p><p>Previously, we have tested JS-2-JSIL against <a href="https://github.com/tc39/test262/commit/91d06f">this commit (from May 30th 2016)</a> of Test262, the JavaScript official test suite. As this commit of Test262 targets ES6, we had to identify the subset of tests that are appropriate for JS-2-JSIL, as explained in detail in [JaVerT], obtaining 8797 applicable tests, of which JS-2-JSIL passes 100%.</p><p>We have initially tested JS-2-GIL successfully on the same 8797 tests and reported this in the submitted version of the paper. However, these tests were not systematically categorised and we were not able to automate the testing process to our satisfaction using the bulk testing mechanism of Gillian. For this reason, we have chosen to work with the latest version of Test262, forked <a href="https://github.com/GillianPlatform/javert-test262">here</a>, where each test comes with a precise description of its intended outcome. For example, a test that is supposed to fail at parsing time with a JavaScript native syntax error will contain the following in its header:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">negative:</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  phase: parse</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  type: SyntaxError</span></div></code></pre></div><p>We re-filter Test262 to find the applicable tests and run them using JS-2-GIL and the concrete semantics of Gillian-JS. The summary results are presented in the table below and will be included in the final version of the paper. A more detailed, per-folder breakdown is available further below.</p><table><thead><tr><th align="center"></th><th align="center">Language</th><th align="center">Built-ins</th><th align="center">Total</th></tr></thead><tbody><tr><td align="center"><strong>Total tests</strong></td><td align="center">3202</td><td align="center">7860</td><td align="center">11062</td></tr><tr><td align="center">Non-strict tests</td><td align="center">583</td><td align="center">136</td><td align="center">719</td></tr><tr><td align="center"><strong>Strict tests</strong></td><td align="center">2619</td><td align="center">7724</td><td align="center">10343</td></tr><tr><td align="center">Non-strict features</td><td align="center">41</td><td align="center">50</td><td align="center">91</td></tr><tr><td align="center">For unimplemented features</td><td align="center">17</td><td align="center">1182</td><td align="center">1199</td></tr><tr><td align="center">Using unimplemented features</td><td align="center">23</td><td align="center">12</td><td align="center">35</td></tr><tr><td align="center">ES6+</td><td align="center">3</td><td align="center">2</td><td align="center">5</td></tr><tr><td align="center"><strong>Applicable</strong></td><td align="center">2535</td><td align="center">6748</td><td align="center">9013</td></tr><tr><td align="center">Passing</td><td align="center">2530</td><td align="center">6745</td><td align="center">9005</td></tr><tr><td align="center">Failing</td><td align="center">5</td><td align="center">3</td><td align="center">8</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="explanation-table-columns"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#explanation-table-columns" title="Direct link to heading">#</a>Explanation: Table Columns</h4><ul><li><strong>Language</strong>: tests for the core language (chapters 8-14 of the <a href="https://www.ecma-international.org/ecma-262/5.1/">ECMAScript ES5 standard</a>).</li><li><strong>Built-ins</strong>: tests for the built-in libraries (chapter 15 of the <a href="https://www.ecma-international.org/ecma-262/5.1/">ECMAScript ES5 standard</a>).</li><li><strong>Total</strong>: all tests.</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="explanation-table-rows"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#explanation-table-rows" title="Direct link to heading">#</a>Explanation: Table Rows</h4><ul><li><strong>Total tests</strong>: all tests.</li><li><strong>Non-strict tests</strong> (filtered out): tests that should be run only in non-strict mode. They contain the <code>flags: [noStrict]</code> directive and are filtered out automatically by our bulk testing mechanism.</li><li><strong>Strict tests</strong>: tests that should be run in strict mode.</li><li><strong>Non-strict features</strong> (filtered out): tests that combine strict and non-strict mode, using either indirect eval or the non-strict <code>Function</code> constructor (91 tests, list available in the <code>non_strict_tests</code> variable of <a href="https://github.com/GillianPlatform/Gillian/blob/PLDI20/Gillian-JS/lib/Test262/Test262_filtering.ml"><code>test262_filtering.ml</code></a>).</li><li><strong>For unimplemented features</strong> (filtered out): tests that test unimplemented features, such as the<code>JSON</code> library (1205 tests, list available in the <code>tests_for_unimplemented_features</code> variable of <a href="https://github.com/GillianPlatform/Gillian/blob/PLDI20/Gillian-JS/lib/Test262/Test262_filtering.ml"><code>test262_filtering.ml</code></a>). Note that the structural tests for some of these features still pass, as we have the appropriate stubs in the initial heap.</li><li><strong>Using unimplemented features</strong> (filtered out): tests that use unimplemented features to test behaviours of implemented features, with the most prominent examples being the <code>Date</code> constructor and <code>RegExp</code> literals (29 tests, list available in the <code>tests_using_unimplemented_features</code> variable of <a href="https://github.com/GillianPlatform/Gillian/blob/PLDI20/Gillian-JS/lib/Test262/Test262_filtering.ml"><code>test262_filtering.ml</code></a>).</li><li><strong>ES6+</strong> (filtered out): tests that use behaviours beyond ES5 (5 tests, list available in the <code>es6_tests</code> variable of <a href="https://github.com/GillianPlatform/Gillian/blob/PLDI20/Gillian-JS/lib/Test262/Test262_filtering.ml"><code>test262_filtering.ml</code></a>). For example, two language tests test for the ES6 completion of the <code>if</code> statement (returns <code>undefined</code> instead of the ES5 <code>empty</code>), one language test uses a function declaration in statement position (disallowed in ES5), and two built-in tests require a specific ordering of object keys (implementation-dependent in ES5).</li><li><strong>Applicable</strong>: the number of tests applicable to JS-2-GIL.</li><li><strong>Passing</strong>: the number of tests passing.</li><li><strong>Failing</strong>: the number of tests failing.</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="explanation-failing-tests"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#explanation-failing-tests" title="Direct link to heading">#</a>Explanation: Failing Tests</h4><p>The following eight tests</p><ul><li><code>test262/test/language/line-terminators/7.3-6.js</code></li><li><code>test262/test/language/line-terminators/7.3-5.js</code></li><li><code>test262/test/language/line-terminators/7.3-15.js</code></li><li><code>test262/test/language/line-terminators/invalid-string-cr.js</code></li><li><code>test262/test/language/source-text/6.1.js</code></li><li><code>test262/test/built-ins/Number/S9.3.1_A3_T1.js</code></li><li><code>test262/test/built-ins/Number/S9.3.1_A3_T2.js</code></li><li><code>test262/test/built-ins/Number/S9.3.1_A2.js</code></li></ul><p>fail due to a discrepancy between how Unicode characters are treated in JavaScript (either UCS-2 or UTF-16) and OCaml (sequences of bytes). One solution would be to move to strings provided by the <a href="http://camomile.sourceforge.net/"><code>Camomile</code></a> library instead of the native OCaml strings.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="reproducing-the-results"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#reproducing-the-results" title="Direct link to heading">#</a>Reproducing the Results</h4><ol><li>Our <a href="https://github.com/GillianPlatform/javert-test262">forked Test262 repository</a> is already cloned on the machine under the path <code>~/test262</code>. Inside that folder, you can find the Test262 tests in the <code>test</code> subfolder. In particular, <code>test/language</code> contains the core language tests, whereas <code>test/built-ins</code> contains the tests for the built-in libraries.</li><li>To run all of the tests, execute the following command inside your Gillian folder:</li></ol><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-bash codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">esy</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">esy x javert bulk-exec </span><span class="token punctuation" style="color:rgb(212, 212, 212)">..</span><span class="token plain">/test262</span></div></code></pre></div><p>The testing should take approximately thirty minutes. The bulk tester will actively report progress, folder-by-folder, and signal any test failures encountered. In the end, a list of all failed tests (the eight given above) will be printed.</p><ol><li>If you would like to test a specific subfolder of the test suite, simply add it to the test path. For example, to run only the tests for <code>Array.prototype.reduce</code>, execute, from the main Gillian folder:</li></ol><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-bash codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">esy x gillian-js test262 </span><span class="token punctuation" style="color:rgb(212, 212, 212)">..</span><span class="token plain">/test262/test/built-ins/Array/prototype/reduce/</span></div></code></pre></div><ol start="4"><li>If you would like to examine the filtered tests, you can find them in <a href="https://github.com/GillianPlatform/Gillian/blob/PLDI20/Gillian-JS/lib/Test262/Test262_filtering.ml"><code>test262_filtering.ml</code></a>.</li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="detailed-per-folder-breakdown-language"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#detailed-per-folder-breakdown-language" title="Direct link to heading">#</a>Detailed Per-Folder Breakdown: Language</h4><table><thead><tr><th align="center"></th><th align="center">arguments-object</th><th align="center">asi</th><th align="center">comments</th><th align="center">directive-prologue</th><th align="center">eval-code</th><th align="center">expressions</th><th align="center">function-code</th><th align="center">future-reserved-words</th><th align="center">global-code</th><th align="center">identifier-resolution</th><th align="center">identifiers</th><th align="center">keywords</th><th align="center">line-terminators</th><th align="center">literals</th><th align="center">punctuators</th><th align="center">reserved-words</th><th align="center">source-text</th><th align="center">statements</th><th align="center">types</th><th align="center">white-space</th><th align="center">Total</th></tr></thead><tbody><tr><td align="center"><strong>All tests</strong></td><td align="center">46</td><td align="center">101</td><td align="center">18</td><td align="center">62</td><td align="center">58</td><td align="center">1469</td><td align="center">212</td><td align="center">55</td><td align="center">3</td><td align="center">11</td><td align="center">49</td><td align="center">25</td><td align="center">41</td><td align="center">145</td><td align="center">11</td><td align="center">13</td><td align="center">1</td><td align="center">733</td><td align="center">109</td><td align="center">40</td><td align="center">3202</td></tr><tr><td align="center"><strong>Non-strict tests</strong></td><td align="center">12</td><td align="center">0</td><td align="center">0</td><td align="center">57</td><td align="center">4</td><td align="center">153</td><td align="center">107</td><td align="center">7</td><td align="center">2</td><td align="center">5</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">227</td><td align="center">9</td><td align="center">0</td><td align="center">583</td></tr><tr><td align="center"><strong>Strict tests</strong></td><td align="center">34</td><td align="center">101</td><td align="center">18</td><td align="center">5</td><td align="center">54</td><td align="center">1316</td><td align="center">105</td><td align="center">48</td><td align="center">1</td><td align="center">6</td><td align="center">49</td><td align="center">25</td><td align="center">41</td><td align="center">145</td><td align="center">11</td><td align="center">13</td><td align="center">1</td><td align="center">506</td><td align="center">100</td><td align="center">40</td><td align="center">2619</td></tr><tr><td align="center"><strong>Non-strict features</strong></td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">25</td><td align="center">1</td><td align="center">5</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">10</td><td align="center">0</td><td align="center">0</td><td align="center">41</td></tr><tr><td align="center"><strong>For unimplemented features</strong></td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">17</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">17</td></tr><tr><td align="center"><strong>Using unimplemented features</strong></td><td align="center">0</td><td align="center">0</td><td align="center">2</td><td align="center">0</td><td align="center">0</td><td align="center">3</td><td align="center">4</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">12</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">2</td><td align="center">0</td><td align="center">0</td><td align="center">23</td></tr><tr><td align="center"><strong>ES6+</strong></td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">3</td><td align="center">0</td><td align="center">0</td><td align="center">3</td></tr><tr><td align="center"><strong>Applicable</strong></td><td align="center">34</td><td align="center">101</td><td align="center">16</td><td align="center">5</td><td align="center">29</td><td align="center">1312</td><td align="center">96</td><td align="center">48</td><td align="center">1</td><td align="center">6</td><td align="center">49</td><td align="center">25</td><td align="center">41</td><td align="center">116</td><td align="center">11</td><td align="center">13</td><td align="center">1</td><td align="center">491</td><td align="center">100</td><td align="center">40</td><td align="center">2535</td></tr><tr><td align="center"><strong>Passing</strong></td><td align="center">34</td><td align="center">101</td><td align="center">16</td><td align="center">5</td><td align="center">29</td><td align="center">1312</td><td align="center">96</td><td align="center">48</td><td align="center">1</td><td align="center">6</td><td align="center">49</td><td align="center">25</td><td align="center">37</td><td align="center">116</td><td align="center">11</td><td align="center">13</td><td align="center">0</td><td align="center">491</td><td align="center">100</td><td align="center">40</td><td align="center">2530</td></tr><tr><td align="center"><strong>Failing</strong></td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">4</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">1</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">5</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="detailed-per-folder-breakdown-built-ins"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#detailed-per-folder-breakdown-built-ins" title="Direct link to heading">#</a>Detailed Per-Folder Breakdown: Built-ins</h4><table><thead><tr><th align="center"></th><th align="center">Array</th><th align="center">Boolean</th><th align="center">Date</th><th align="center">decodeURI</th><th align="center">decodeURIComponent</th><th align="center">encodeURI</th><th align="center">encodeURIComponent</th><th align="center">Error</th><th align="center">eval</th><th align="center">Function</th><th align="center">global</th><th align="center">Infinity</th><th align="center">isFinite</th><th align="center">isNan</th><th align="center">JSON</th><th align="center">Math</th><th align="center">NaN</th><th align="center">Number</th><th align="center">Object</th><th align="center">parseFloat</th><th align="center">parseInt</th><th align="center">RegExp</th><th align="center">String</th><th align="center">undefined</th><th align="center">Total</th></tr></thead><tbody><tr><td align="center"><strong>All tests</strong></td><td align="center">2171</td><td align="center">42</td><td align="center">430</td><td align="center">52</td><td align="center">52</td><td align="center">28</td><td align="center">28</td><td align="center">33</td><td align="center">7</td><td align="center">398</td><td align="center">31</td><td align="center">7</td><td align="center">2</td><td align="center">2</td><td align="center">90</td><td align="center">81</td><td align="center">7</td><td align="center">152</td><td align="center">2892</td><td align="center">40</td><td align="center">57</td><td align="center">501</td><td align="center">749</td><td align="center">8</td><td align="center">7860</td></tr><tr><td align="center"><strong>Non-strict tests</strong></td><td align="center">27</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">88</td><td align="center">4</td><td align="center">2</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">2</td><td align="center">0</td><td align="center">7</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">3</td><td align="center">3</td><td align="center">136</td></tr><tr><td align="center"><strong>Strict tests</strong></td><td align="center">2144</td><td align="center">42</td><td align="center">430</td><td align="center">52</td><td align="center">52</td><td align="center">28</td><td align="center">28</td><td align="center">33</td><td align="center">7</td><td align="center">310</td><td align="center">27</td><td align="center">5</td><td align="center">2</td><td align="center">2</td><td align="center">90</td><td align="center">81</td><td align="center">5</td><td align="center">152</td><td align="center">2885</td><td align="center">40</td><td align="center">57</td><td align="center">501</td><td align="center">746</td><td align="center">5</td><td align="center">7724</td></tr><tr><td align="center"><strong>Non-strict features</strong></td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">50</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">50</td></tr><tr><td align="center"><strong>For unimplemented</strong></td><td align="center">0</td><td align="center">0</td><td align="center">17</td><td align="center">45</td><td align="center">45</td><td align="center">21</td><td align="center">21</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">81</td><td align="center">0</td><td align="center">0</td><td align="center">5</td><td align="center">5</td><td align="center">33</td><td align="center">50</td><td align="center">455</td><td align="center">404</td><td align="center">0</td><td align="center">1182</td></tr><tr><td align="center"><strong>Using unimplemented features</strong></td><td align="center">3</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">3</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">6</td><td align="center">0</td><td align="center">12</td></tr><tr><td align="center"><strong>ES6+</strong></td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">2</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">2</td></tr><tr><td align="center"><strong>Applicable</strong></td><td align="center">2141</td><td align="center">42</td><td align="center">413</td><td align="center">7</td><td align="center">7</td><td align="center">7</td><td align="center">7</td><td align="center">33</td><td align="center">7</td><td align="center">257</td><td align="center">27</td><td align="center">5</td><td align="center">2</td><td align="center">2</td><td align="center">9</td><td align="center">81</td><td align="center">5</td><td align="center">147</td><td align="center">2878</td><td align="center">7</td><td align="center">7</td><td align="center">46</td><td align="center">336</td><td align="center">5</td><td align="center">6748</td></tr><tr><td align="center"><strong>Passing</strong></td><td align="center">2141</td><td align="center">42</td><td align="center">413</td><td align="center">7</td><td align="center">7</td><td align="center">7</td><td align="center">7</td><td align="center">33</td><td align="center">7</td><td align="center">257</td><td align="center">27</td><td align="center">5</td><td align="center">2</td><td align="center">2</td><td align="center">9</td><td align="center">81</td><td align="center">5</td><td align="center">144</td><td align="center">2878</td><td align="center">7</td><td align="center">7</td><td align="center">46</td><td align="center">336</td><td align="center">5</td><td align="center">6745</td></tr><tr><td align="center"><strong>Failing</strong></td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">3</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">3</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="writing-symbolic-tests"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#writing-symbolic-tests" title="Direct link to heading">#</a>Writing Symbolic Tests</h3><p>The whole-program symbolic testing module of Gillian-JS (codenamed Cosette) extends JavaScript with a mechanism for declaring symbolic variables and performing first-order reasoning on them.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="declaring-symbolic-variables"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#declaring-symbolic-variables" title="Direct link to heading">#</a>Declaring Symbolic Variables</h4><p>One can declare untyped symbolic variables, symbolic booleans, symbolic strings, and symbolic numbers as follows:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-javascript codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">var</span><span class="token plain"> x </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">symb</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// Untyped symbolic variable</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">var</span><span class="token plain"> b </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">symb_number</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">b</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// Symbolic boolean</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">var</span><span class="token plain"> n </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">symb_number</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// Symbolic number</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">var</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">symb_string</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// Symbolic string</span></div></code></pre></div><p>The single parameters provided to these functions indicate the name of the created symbol, or <em>logical variable</em>, that Cosette will use in the reasoning. Normally, we choose these to coincide with the JavaScript variables in which they are stored so that the outputs of the analysis are more readable.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="assumptions-and-assertions"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#assumptions-and-assertions" title="Direct link to heading">#</a>Assumptions and Assertions</h4><p>Cosette provides a mechanism for reasoning about the symbols, in the form of assumptions and assertions, as follows:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-javascript codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token function maybe-class-name" style="color:rgb(220, 220, 170)">Assume</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token constant" style="color:rgb(100, 102, 149)">B</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// Assume that the boolean expression B holds</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function maybe-class-name" style="color:rgb(220, 220, 170)">Assert</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token constant" style="color:rgb(100, 102, 149)">B</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// Assert that the boolean expression B holds</span></div></code></pre></div><p>The grammar of boolean expressions (<code>B</code>) and expressions (<code>E</code>) is (approximately) as follows:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-c codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">B </span><span class="token operator" style="color:rgb(212, 212, 212)">::</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> x                         </span><span class="token comment" style="color:rgb(106, 153, 85)">// (Boolean) variables</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> E </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> E                     </span><span class="token comment" style="color:rgb(106, 153, 85)">// Equality</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> E </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain"> E </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> E </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;=</span><span class="token plain"> E            </span><span class="token comment" style="color:rgb(106, 153, 85)">// Comparison</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> not B </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> B and B </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> B or B  </span><span class="token comment" style="color:rgb(106, 153, 85)">// Logical operators</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">E </span><span class="token operator" style="color:rgb(212, 212, 212)">::</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> c                           </span><span class="token comment" style="color:rgb(106, 153, 85)">// Constants</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> x                           </span><span class="token comment" style="color:rgb(106, 153, 85)">// Variables</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> E </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> E </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> E </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> E </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">         </span><span class="token comment" style="color:rgb(106, 153, 85)">// Numeric operators</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> E </span><span class="token operator" style="color:rgb(212, 212, 212)">++</span><span class="token plain"> E </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> s</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">len E </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> s</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">nth E  </span><span class="token comment" style="color:rgb(106, 153, 85)">// String concat, length, and n-th</span></div></code></pre></div><p>Here is the example of a symbolic test using assumptions and assertions:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-javascript codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">// Create two symbolic numbers</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">var</span><span class="token plain"> n1 </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">symb_number</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">n1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> n2 </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">symb_number</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">n2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// Assume that they are non-negative and different</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function maybe-class-name" style="color:rgb(220, 220, 170)">Assume</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;=</span><span class="token plain"> n1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">and</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;=</span><span class="token plain"> n2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">and</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">not</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">n1 </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> n2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// Perform some calculations</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">var</span><span class="token plain"> res </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">f</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">n1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> n2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// Assert, for example, that n1 and n2 are not greater than the result</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function maybe-class-name" style="color:rgb(220, 220, 170)">Assert</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">n1 </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;=</span><span class="token plain"> res</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">and</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">n2 </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;=</span><span class="token plain"> res</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></div></code></pre></div><p>This example is already in the repository (with <code>f</code> instantiated to <code>n1 + n2</code>), and you can run it, starting from the <code>Gillian</code> folder, as follows:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-bash codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">esy</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">esy init:env</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(78, 201, 176)">cd</span><span class="token plain"> JaVerT/environment</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">esy x gillian-js wpst Examples/Cosette/simple_example.js -s</span></div></code></pre></div><p>Since the assertion in the end does hold, there will be no output from Cosette, meaning that the test has passed. If however, you change <code>n1 + n2</code> to <code>n1 * n2</code> and re-run the example, you will be faced with the following error message and counter-model:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">Assert failed with argument ((#n1 &lt;=# (#n1 * #n2)) /\ (#n2 &lt;=# (#n1 * #n2))).</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Failing Model:</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  [ (#n2: 1), (#n1: 0) ]</span></div></code></pre></div><p>which means that the assertion does not hold if <code>n1 = 0</code> and <code>n2 = 1</code>. Here, variables prefixed by <code>#</code> denote logical variables; in this case, the parameters given to the <code>symb_number</code> function.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="semantics-of-operators"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#semantics-of-operators" title="Direct link to heading">#</a>Semantics of Operators</h4><p>Importantly, the semantics of all of the operators in assumptions and assertions is deliberately <strong>NOT</strong> as in JavaScript. For example, comparison and numeric operators do not perform any implicit type coercions. If you want to use JavaScript comparison/numeric operators, say <code>&lt;=</code>, you can proceed as follows:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-javascript codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">var</span><span class="token plain"> res_leq_n1 </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> n1 </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;=</span><span class="token plain"> res</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function maybe-class-name" style="color:rgb(220, 220, 170)">Assert</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">n1_leq_res</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></div></code></pre></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="typing-and-objects-in-symbolic-tests"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#typing-and-objects-in-symbolic-tests" title="Direct link to heading">#</a>Typing and Objects in Symbolic Tests</h4><p>Since we do not (yet) perform lazy initialisation in symbolic execution, errors may occur if you attempt to reason about symbolic objects or untyped symbolic variables. This can be prevented as follows:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-javascript codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">var</span><span class="token plain"> x </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">symb</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function maybe-class-name" style="color:rgb(220, 220, 170)">Assume</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">not</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">typeOf x </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token maybe-class-name">Obj</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></div></code></pre></div><p>where <code>typeOf</code> is the built-in GIL typing operator and <code>Obj</code> is the built-in GIL object type. In this way, it is guaranteed that <code>x</code> is not an object (but still may be equal to <code>null</code>).</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="symbolic-testing-of-bucketsjs"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#symbolic-testing-of-bucketsjs" title="Direct link to heading">#</a>Symbolic Testing of Buckets.js</h3><p>We symbolically test Buckets.js, a real-world JavaScript data-structure library, with the goal of obtaining 100% line coverage. The results are presented in the table below, with each row containing:</p><ul><li>The name of the folder being tested, which also indicates the data structure in question</li><li>The number of tests required for 100% line coverage</li><li>The total number of GIL commands executed by running these tests</li><li>The total testing time (in seconds)</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="testing-results"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#testing-results" title="Direct link to heading">#</a>Testing Results</h4><table><thead><tr><th align="center">Data Structure</th><th align="center">Tests</th><th align="center">GIL Commands</th><th align="center">Time (s)</th></tr></thead><tbody><tr><td align="center"><strong>arrays</strong></td><td align="center">9</td><td align="center">330,147</td><td align="center">2.584</td></tr><tr><td align="center"><strong>bag</strong></td><td align="center">7</td><td align="center">1,343,393</td><td align="center">4.813</td></tr><tr><td align="center"><strong>bstree</strong></td><td align="center">11</td><td align="center">3,751,092</td><td align="center">10.370</td></tr><tr><td align="center"><strong>dictionary</strong></td><td align="center">7</td><td align="center">401,575</td><td align="center">1.884</td></tr><tr><td align="center"><strong>heap</strong></td><td align="center">4</td><td align="center">1,492,204</td><td align="center">2.932</td></tr><tr><td align="center"><strong>linkedlist</strong></td><td align="center">9</td><td align="center">588,714</td><td align="center">3.999</td></tr><tr><td align="center"><strong>multidictionary</strong></td><td align="center">6</td><td align="center">1,106,650</td><td align="center">3.772</td></tr><tr><td align="center"><strong>priorityqueue</strong></td><td align="center">5</td><td align="center">2,312,226</td><td align="center">3.871</td></tr><tr><td align="center"><strong>queue</strong></td><td align="center">6</td><td align="center">407,106</td><td align="center">2.090</td></tr><tr><td align="center"><strong>set</strong></td><td align="center">6</td><td align="center">2,178,222</td><td align="center">4.457</td></tr><tr><td align="center"><strong>stack</strong></td><td align="center">4</td><td align="center">306,449</td><td align="center">1.661</td></tr><tr><td align="center"><strong>Total</strong></td><td align="center"><strong>74</strong></td><td align="center"><strong>14,217,778</strong></td><td align="center"><strong>42.443</strong></td></tr></tbody></table><p>The current results are faster than reported in the submitted version. This is a result of improvements to the Gillian/Gillian-JS symbolic engine.
On the other hand, the number of run commands is marginally greater, due to minor changes to the JS-2-GIL compiler and the symbolic engine.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="reproducing-the-results-1"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#reproducing-the-results-1" title="Direct link to heading">#</a>Reproducing the Results</h4><p>Starting from the <code>Gillian</code> folder, execute the following:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-bash codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">esy</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">esy init:env</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(78, 201, 176)">cd</span><span class="token plain"> Gillian-JS/environment</span></div></code></pre></div><p>Then, to reproduce the results for a specific folder from the first column of the above table, execute the following:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-bash codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">./testCosetteFolder.sh Examples/Cosette/Buckets/</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">folder</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span></div></code></pre></div><p>In order to obtain the number of executed commands, append the <code>count</code> parameter to the last command. Therefore, for example, the command to run the tests for the <code>queue</code> data structure and obtain the number of executed commands is</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-bash codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">./testCosetteFolder.sh Examples/Cosette/Buckets/queue count</span></div></code></pre></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="notes"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#notes" title="Direct link to heading">#</a>Notes</h5><ol><li>The times obtained in the VM should be representative if run on a machine with a comparable specification (Intel Core i7-4980HQ CPU 2.80 GHz, DDR3 RAM 16GB, 256GB SSD) with no other applications running. Some (proportional) discrepancy is to be expected.</li><li>The times obtained when counting executed commands will be slower, due to the fact that the tests will be run in single-threaded mode.</li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="detailed-per-folder-breakdown-bucketsjs"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#detailed-per-folder-breakdown-bucketsjs" title="Direct link to heading">#</a>Detailed Per-Folder Breakdown: Buckets.js</h4><table><thead><tr><th align="center"><strong>arrays</strong></th><th align="center">1</th><th align="center">2</th><th align="center">3</th><th align="center">4</th><th align="center">5</th><th align="center">6</th><th align="center">7</th><th align="center">8</th><th align="center">9</th><th align="center"><strong>Total</strong></th></tr></thead><tbody><tr><td align="center"><strong>Time (s)</strong></td><td align="center">0.261</td><td align="center">0.269</td><td align="center">0.254</td><td align="center">0.270</td><td align="center">0.263</td><td align="center">0.294</td><td align="center">0.251</td><td align="center">0.488</td><td align="center">0.234</td><td align="center">2.584</td></tr><tr><td align="center"><strong>GIL Commands</strong></td><td align="center">33,903</td><td align="center">34,675</td><td align="center">34,896</td><td align="center">42,866</td><td align="center">30,483</td><td align="center">55,210</td><td align="center">34,765</td><td align="center">39,532</td><td align="center">23,817</td><td align="center">330,147</td></tr></tbody></table><table><thead><tr><th align="center"><strong>bag</strong></th><th align="center">1</th><th align="center">2</th><th align="center">3</th><th align="center">4</th><th align="center">5</th><th align="center">6</th><th align="center">7</th><th align="center"><strong>Total</strong></th></tr></thead><tbody><tr><td align="center"><strong>Time (s)</strong></td><td align="center">0.485</td><td align="center">0.430</td><td align="center">0.922</td><td align="center">0.604</td><td align="center">0.553</td><td align="center">0.887</td><td align="center">0.932</td><td align="center">4.813</td></tr><tr><td align="center"><strong>GIL Commands</strong></td><td align="center">99,395</td><td align="center">60,935</td><td align="center">301,687</td><td align="center">208,336</td><td align="center">158,635</td><td align="center">200,411</td><td align="center">313,994</td><td align="center">1,343,393</td></tr></tbody></table><table><thead><tr><th align="center"><strong>bstree</strong></th><th align="center">1</th><th align="center">2</th><th align="center">3</th><th align="center">4</th><th align="center">5</th><th align="center">6</th><th align="center">7</th><th align="center">8</th><th align="center">9</th><th align="center">10</th><th align="center">11</th><th align="center"><strong>Total</strong></th></tr></thead><tbody><tr><td align="center"><strong>Time (s)</strong></td><td align="center">0.659</td><td align="center">1.728</td><td align="center">0.626</td><td align="center">0.689</td><td align="center">0.921</td><td align="center">0.906</td><td align="center">0.908</td><td align="center">0.980</td><td align="center">0.671</td><td align="center">0.697</td><td align="center">1.585</td><td align="center">10.370</td></tr><tr><td align="center"><strong>GIL Commands</strong></td><td align="center">99,395</td><td align="center">60,935</td><td align="center">301,687</td><td align="center">208,336</td><td align="center">158,635</td><td align="center">200,411</td><td align="center">313,994</td><td align="center">1,343,393</td><td align="center"></td><td align="center"></td><td align="center"></td><td align="center"></td></tr></tbody></table><table><thead><tr><th align="center"><strong>dictionary</strong></th><th align="center">1</th><th align="center">2</th><th align="center">3</th><th align="center">4</th><th align="center">5</th><th align="center">6</th><th align="center">7</th><th align="center"><strong>Total</strong></th></tr></thead><tbody><tr><td align="center"><strong>Time (s)</strong></td><td align="center">0.298</td><td align="center">0.238</td><td align="center">0.218</td><td align="center">0.363</td><td align="center">0.240</td><td align="center">0.226</td><td align="center">0.301</td><td align="center">1.884</td></tr><tr><td align="center"><strong>GIL Commands</strong></td><td align="center">61,161</td><td align="center">54,140</td><td align="center">44,569</td><td align="center">55,033</td><td align="center">55,914</td><td align="center">41,904</td><td align="center">88,854</td><td align="center">401,575</td></tr></tbody></table><table><thead><tr><th align="center"><strong>heap</strong></th><th align="center">1</th><th align="center">2</th><th align="center">3</th><th align="center">4</th><th align="center"><strong>Total</strong></th></tr></thead><tbody><tr><td align="center"><strong>Time (s)</strong></td><td align="center">0.560</td><td align="center">1.199</td><td align="center">0.507</td><td align="center">0.666</td><td align="center">2.932</td></tr><tr><td align="center"><strong>GIL Commands</strong></td><td align="center">135,140</td><td align="center">804,659</td><td align="center">169,522</td><td align="center">382,883</td><td align="center">1,492,204</td></tr></tbody></table><table><thead><tr><th align="center"><strong>linkedlist</strong></th><th align="center">1</th><th align="center">2</th><th align="center">3</th><th align="center">4</th><th align="center">5</th><th align="center">6</th><th align="center">7</th><th align="center">8</th><th align="center">9</th><th align="center"><strong>Total</strong></th></tr></thead><tbody><tr><td align="center"><strong>Time (s)</strong></td><td align="center">0.547</td><td align="center">0.572</td><td align="center">0.588</td><td align="center">0.445</td><td align="center">0.291</td><td align="center">0.289</td><td align="center">0.270</td><td align="center">0.644</td><td align="center">0.353</td><td align="center">3.999</td></tr><tr><td align="center"><strong>GIL Commands</strong></td><td align="center">43,209</td><td align="center">57,458</td><td align="center">97,728</td><td align="center">82,345</td><td align="center">63,645</td><td align="center">66,093</td><td align="center">30,794</td><td align="center">97,225</td><td align="center">50,217</td><td align="center">588,714</td></tr></tbody></table><table><thead><tr><th align="center"><strong>multidictionary</strong></th><th align="center">1</th><th align="center">2</th><th align="center">3</th><th align="center">4</th><th align="center">5</th><th align="center">6</th><th align="center"><strong>Total</strong></th></tr></thead><tbody><tr><td align="center"><strong>Time (s)</strong></td><td align="center">0.488</td><td align="center">0.812</td><td align="center">0.586</td><td align="center">0.576</td><td align="center">0.684</td><td align="center">0.626</td><td align="center">3.772</td></tr><tr><td align="center"><strong>GIL Commands</strong></td><td align="center">130,145</td><td align="center">312,351</td><td align="center">166,638</td><td align="center">145,627</td><td align="center">158,934</td><td align="center">192,955</td><td align="center">1,106,650</td></tr></tbody></table><table><thead><tr><th align="center"><strong>priorityqueue</strong></th><th align="center">1</th><th align="center">2</th><th align="center">3</th><th align="center">4</th><th align="center">5</th><th align="center"><strong>Total</strong></th></tr></thead><tbody><tr><td align="center"><strong>Time (s)</strong></td><td align="center">0.713</td><td align="center">0.711</td><td align="center">0.490</td><td align="center">0.884</td><td align="center">1.073</td><td align="center">3.871</td></tr><tr><td align="center"><strong>GIL Commands</strong></td><td align="center">399,730</td><td align="center">287,433</td><td align="center">121,329</td><td align="center">450,539</td><td align="center">1,053,195</td><td align="center">2,312,226</td></tr></tbody></table><table><thead><tr><th align="center"><strong>queue</strong></th><th align="center">1</th><th align="center">2</th><th align="center">3</th><th align="center">4</th><th align="center">5</th><th align="center">6</th><th align="center"><strong>Total</strong></th></tr></thead><tbody><tr><td align="center"><strong>Time (s)</strong></td><td align="center">0.488</td><td align="center">0.812</td><td align="center">0.586</td><td align="center">0.576</td><td align="center">0.684</td><td align="center">0.626</td><td align="center">3.772</td></tr><tr><td align="center"><strong>GIL Commands</strong></td><td align="center">71,514</td><td align="center">69,962</td><td align="center">45,067</td><td align="center">36,767</td><td align="center">62,624</td><td align="center">121,172</td><td align="center">407,106</td></tr></tbody></table><table><thead><tr><th align="center"><strong>set</strong></th><th align="center">1</th><th align="center">2</th><th align="center">3</th><th align="center">4</th><th align="center">5</th><th align="center">6</th><th align="center"><strong>Total</strong></th></tr></thead><tbody><tr><td align="center"><strong>Time (s)</strong></td><td align="center">0.408</td><td align="center">0.677</td><td align="center">1.661</td><td align="center">0.647</td><td align="center">0.310</td><td align="center">0.754</td><td align="center">4.457</td></tr><tr><td align="center"><strong>GIL Commands</strong></td><td align="center">78,959</td><td align="center">242,304</td><td align="center">1,265,278</td><td align="center">232,776</td><td align="center">66,700</td><td align="center">292,205</td><td align="center">2,178,222</td></tr></tbody></table><table><thead><tr><th align="center"><strong>stack</strong></th><th align="center">1</th><th align="center">2</th><th align="center">3</th><th align="center">4</th><th align="center"><strong>Total</strong></th></tr></thead><tbody><tr><td align="center"><strong>Time (s)</strong></td><td align="center">0.352</td><td align="center">0.324</td><td align="center">0.349</td><td align="center">0.636</td><td align="center">1.661</td></tr><tr><td align="center"><strong>GIL Commands</strong></td><td align="center">52,233</td><td align="center">44,958</td><td align="center">55,097</td><td align="center">154,161</td><td align="center">306,449</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="reproducing-the-bucketsjs-bugs-found-by-cosette-and-javert-20"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#reproducing-the-bucketsjs-bugs-found-by-cosette-and-javert-20" title="Direct link to heading">#</a>Reproducing the Buckets.js Bugs found by [Cosette] and [JaVerT 2.0]</h3><p>Starting from the main Gillian folder, execute the following:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-bash codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">esy</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">esy init:env</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(78, 201, 176)">cd</span><span class="token plain"> Gillian-JS/environment</span></div></code></pre></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="cosette-multi-dictionary-bug"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#cosette-multi-dictionary-bug" title="Direct link to heading">#</a>[Cosette] Multi-Dictionary Bug</h3><p>In order to reproduce the multi-dictionary bug reported by <a href="references.md#cosette-symbolic-execution-for-javascript">[Cosette]</a>, execute:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-bash codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">./testCosette.sh Examples/Cosette/Buckets/multidictionary/bug/multidictionary_bug.js</span></div></code></pre></div><p>You will obtain a failing model</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">Assert failed with argument False.</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Failing Model:</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  [ (#x1: #x2) ]</span></div></code></pre></div><p>The bug is caused by the library wrongly treating the case in which we try to remove a key-value pair for a key with no associated values. The code of the test is as follows:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-javascript codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">var</span><span class="token plain"> dict </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">buckets</span><span class="token class-name punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token class-name" style="color:rgb(78, 201, 176)">MultiDictionary</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">var</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">symb_string</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">var</span><span class="token plain"> x1 </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">symb_number</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">x1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">var</span><span class="token plain"> x2 </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">symb_number</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">x2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">dict</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">set</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> x1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">dict</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">set</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> x2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">dict</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">remove</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> x1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">var</span><span class="token plain"> res </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> dict</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">remove</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> x2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function maybe-class-name" style="color:rgb(220, 220, 170)">Assert</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">not</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">x1 </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> x2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">and</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">res </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">or</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">x1 </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> x2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">and</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">res </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></div></code></pre></div><p>The test puts two symbolic numbers, <code>x1</code> and <code>x2</code> for the same symbolic key <code>s</code> into an empty multidictionary, then removes <code>x1</code>, and then removes <code>x2</code> and registers the value returned by <code>remove</code>. Then, it asserts that that value was <code>true</code> if the two keys were different, and <code>false</code> if the two keys were the same. What the failing model says is that, when the two keys are equal, the library, in fact, throws a native JavaScript error (indicated by the argument <code>False</code> of the failed assert).</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="javert-20-linked-list-bugs"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#javert-20-linked-list-bugs" title="Direct link to heading">#</a>[JaVerT 2.0] Linked-List Bugs</h3><p>In order to reproduce the linked-list bugs reported by <a href="references.md#javert20-compositional-symbolic-execution-for-javascript">[JaVerT 2.0]</a>, execute:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-bash codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">./testCosette.sh Examples/Cosette/Buckets/linkedlist/bug/linkedlist_bug_1.js</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">./testCosette.sh Examples/Cosette/Buckets/linkedlist/bug/linkedlist_bug_2.js</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">./testCosette.sh Examples/Cosette/Buckets/linkedlist/bug/linkedlist_bug_3.js</span></div></code></pre></div><p>All of the bugs are caused by the library treating non-integer indexing incorrectly; we explain the bug found by the first test in detail, the remaining two are analogous. For the first test, the failing model is as follows:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">Assert failed with argument</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  ((((#x3 == 0) /\ (#x2 == #x1)) \/</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    ((#x3 == 1) /\ (#x2 == #x2))) \/</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    (((! (#x3 == 0)) /\ (! (#x3 == 1))) /\ (#x2 == undefined))).</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Failing Model:</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  [ (#x2: 4), (#x3: 0.5), (#x1: 3) ]</span></div></code></pre></div><p>The code of the test is as follows:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-javascript codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">var</span><span class="token plain"> list </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">buckets</span><span class="token class-name punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token class-name" style="color:rgb(78, 201, 176)">LinkedList</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">var</span><span class="token plain"> x1 </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">symb_number</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">x1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">var</span><span class="token plain"> x2 </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">symb_number</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">x2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">var</span><span class="token plain"> x3 </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">symb_number</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">x3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">list</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">add</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">x1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">list</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">add</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">x2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">var</span><span class="token plain"> res </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> list</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">elementAtIndex</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">x3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function maybe-class-name" style="color:rgb(220, 220, 170)">Assert</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">x3 </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">and</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">res </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> x1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">or</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">         </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">x3 </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">and</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">res </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> x2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">or</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">         </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">not</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">x3 </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">and</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">not</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">x3 </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">and</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">res </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword nil" style="color:rgb(86, 156, 214)">undefined</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></div></code></pre></div><p>The test inserts two symbolic numbers, <code>x1</code> and <code>x2</code>, into an empty linked list, and then indexes the list with a third symbolic number, <code>x3</code>. The expected outcome is that: if <code>x3 = 0</code>, the indexing returns <code>x1</code>; if <code>x3 = 1</code>, the indexing returns <code>x2</code>; and, otherwise, the indexing returns <code>undefined</code>. The failing model, however, says that if <code>x3 = 0.5</code>, the indexing will also return <code>x2</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="gillian-c-section-42"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#gillian-c-section-42" title="Direct link to heading">#</a>Gillian-C (Section 4.2)</h2><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></div>info</h5></div><div class="admonition-content"><p>Folders marked with the (❌PLDI20) annotation are out of scope for this submission.</p></div></div><p><code>Gillian-C</code> is the instantiation of Gillian to the C language. More precisely, to <a href="http://compcert.inria.fr/">CompCert-C</a>). It can be found in the <code>Gillian-C</code> folder of the repository. Its implementation consists of the following:</p><ul><li><strong>Gillian-C</strong><ul><li><code>bin</code>: Source of the <code>gillian-c</code> executable.</li><li><code>environment</code>: Execution environment, not part of the repository, created using <code>esy init:env</code>. It contains useful scripts for testing Gillian-C, and examples are copied in it so that they can be safely modified.</li><li><code>examples</code>: Various examples.<ul><li><code>concrete</code>: Small data-structure examples for concrete execution.</li><li><code>symbolic</code>: Small data-structure examples for symbolic testing.</li><li><code>klee</code>: Same small data-structure examples as in <code>symbolic</code> but written for usage with KLEE.</li><li><code>verification</code>: Small data-structure examples for verification mode (❌PLDI20).</li><li><code>act</code>: Small data-structure examples for Automatic Compositional Testing mode (❌PLDI20).</li></ul></li><li><code>lib</code>: The core of Gillian-C.<ul><li><code>gilgen.ml/mli</code>: Compiler from C#m to GIL.</li><li><code>gil_logic_gen.ml</code>, <code>annot_lexer.mll</code>, <code>annot_parser.mly</code>, <code>cLogic.ml</code>: Utils for handling a small annotation language for C (❌PLDI20).</li><li><code>valueTranslation.ml/mli</code>: Serialisation and deserialisation of CompCert values into GIL values.</li><li><code>semantics.ml/mli</code>: Concrete and symbolic memory models.</li><li><code>cRunner.ml</code>, <code>sRunner.ml</code>: Configuration for the symbolic and concrete bulk testers (<code>gillian-c bulk-wpst</code> and <code>gillian-c bulk-exec</code>).</li><li>Other files: Utilities such as name generators or configuration flags.</li></ul></li><li><code>runtime</code>: Implementation of the internals and part of the C standard lib in GIL.</li><li><code>scripts</code>: Various scripts for setting up the environment and executing analyses.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="writing-symbolic-tests-1"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#writing-symbolic-tests-1" title="Direct link to heading">#</a>Writing Symbolic Tests</h3><p>The whole-program symbolic testing aspect of Gillian-C is very similar to that of <a href="https://klee.github.io">KLEE</a>.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="declaring-symbolic-variables-1"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#declaring-symbolic-variables-1" title="Direct link to heading">#</a>Declaring Symbolic Variables</h4><p>In order to declare symbolic variables, we hijack the <code>__builtin_annot_intval</code> function of CompCert. A symbolic integer, for example, is declared in the following way:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-c codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">int</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">__builtin_annot_intval</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;symb_int&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span></div></code></pre></div><p>As Gillian-C is at an early stage, it is not yet possible to declare variables of symbolic size in memory. It is, however, possible to declare a symbolic string of fixed size by declaring all of its components one-by-one. For example, this is how you can define a one-element string:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-c codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">int</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">__builtin_annot_intval</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;symb_int&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">char</span><span class="token plain"> c_a </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">char</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">char</span><span class="token plain"> str_a</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> c_a</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;\0&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></div></code></pre></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="assumptions-and-assertions-1"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#assumptions-and-assertions-1" title="Direct link to heading">#</a>Assumptions and Assertions</h4><p>For any <code>C</code> boolean expression <code>e</code>, it is possible to state assumptions and assertions of the form:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-c codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">ASSUME</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">ASSERT</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></div></code></pre></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="semantics-of-operators-1"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#semantics-of-operators-1" title="Direct link to heading">#</a>Semantics of Operators</h4><p>In Gillian-C, unlike in Gillian-JS, the semantics of all of the operators in assumptions and assertions is that of C. What happens internally is that, first, the expression <code>e</code> is compiled to a sequence of commands (as C expressions can have side-effects but GIL expressions cannot).
The resulting GIL expression will then contain a <q>serialised C integer</q> (as <code>C</code> booleans are actually integers that have value 0 or 1).
A C integer is serialised in GIL as a two-element list of the form <code>{{ &quot;int&quot;, x }}</code> where <code>x</code> is a GIL number.
<code>ASSUME</code> then calls the GIL state function <code>assume</code> in the form <code>assume(e = {{ &quot;int&quot;, 1 }})</code>, which effectively means, given the semantics of GIL: <q>branch on the obtained boolean expression equalling <code>true</code> and cut the branch in which it is not</q>.
<code>ASSERT</code> works analogously, in that it calls the GIL state function <code>assert</code> instead of <code>assume</code>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="symbolic-testing-of-collections-c"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#symbolic-testing-of-collections-c" title="Direct link to heading">#</a>Symbolic Testing of Collections-C</h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="test-results"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#test-results" title="Direct link to heading">#</a>Test results</h4><p>We symbolically test <a href="https://github.com/srdja/Collections-C">Collections-C</a>, a real-world C data-structure library for C.
The results are presented in the table below, with each row containing:</p><ul><li>The name of the folder being tested, which also indicates the data structure in question</li><li>The number of tests</li><li>The total number of GIL commands executed during these tests</li><li>The total testing time in Gillian-C (in seconds)</li><li>The total testing time in KLEE (in seconds)</li></ul><table><thead><tr><th align="center"></th><th align="center"><strong>Tests</strong></th><th align="center"><strong>GIL Commands</strong></th><th align="center"><strong>Time(s)</strong></th><th align="center"><strong>KLEE Time(s)</strong></th></tr></thead><tbody><tr><td align="center"><strong>array</strong></td><td align="center">22</td><td align="center">123,377</td><td align="center">4.979</td><td align="center">5.062</td></tr><tr><td align="center"><strong>deque</strong></td><td align="center">34</td><td align="center">186,627</td><td align="center">5.383</td><td align="center">5.515</td></tr><tr><td align="center"><strong>list</strong></td><td align="center">37</td><td align="center">478,773</td><td align="center">7.420</td><td align="center">6.875</td></tr><tr><td align="center"><strong>pqueue</strong></td><td align="center">2</td><td align="center">15,726</td><td align="center">0.568</td><td align="center">0.246</td></tr><tr><td align="center"><strong>queue</strong></td><td align="center">4</td><td align="center">39,478</td><td align="center">0.474</td><td align="center">0.463</td></tr><tr><td align="center"><strong>ring_buffer</strong></td><td align="center">3</td><td align="center">27,284</td><td align="center">0.236</td><td align="center">0.319</td></tr><tr><td align="center"><strong>slist</strong></td><td align="center">38</td><td align="center">415,305</td><td align="center">7.308</td><td align="center">6.732</td></tr><tr><td align="center"><strong>stack</strong></td><td align="center">2</td><td align="center">5,211</td><td align="center">0.216</td><td align="center">0.208</td></tr><tr><td align="center"><strong>treeset</strong></td><td align="center">6</td><td align="center">108,583</td><td align="center">1.800</td><td align="center">2.430</td></tr><tr><td align="center"><strong>treetable</strong></td><td align="center">13</td><td align="center">162,608</td><td align="center">3.396</td><td align="center">3.380</td></tr><tr><td align="center"><strong>Total</strong></td><td align="center">161</td><td align="center">1,562,972</td><td align="center">31.780</td><td align="center">31.229</td></tr></tbody></table><p>A detailed breakdown of the testing results is given below.</p><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></div>warning</h5></div><div class="admonition-content"><p>The times given in the paper were incorrectly measured, both for Gillian-C and for KLEE.
For Gillian-C, our multi-threading mechanism was reporting completion time incorrectly, before all spawned threads terminated.
We have fixed this, and also improved the performance of our Gillian/Gillian-C symbolic engine.
For KLEE, we have only counted the user time reported by the <code>time</code> command.
We have consulted the KLEE development team in order to measure the times appropriately.
All KLEE times were obtained by running KLEE in a docker image on the same machine on which we tested Gillian-JS/Gillian-C, with no other applications open.</p><p>Additionally, we have simplified some of the tests (the coverage remains the same), resulting in a fewer number of executed GIL commands.</p><p>These new results are still consistent with our claims in the paper: the performance of Gillian-C is comparable to that of KLEE.</p></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="resulting-fixes"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#resulting-fixes" title="Direct link to heading">#</a>Resulting Fixes</h4><p>The symbolic testing of Collections-C led to the following bug-fixing pull requests.
They fix previously unknown bugs and usage of undefined behaviours:</p><ul><li><a href="https://github.com/srdja/Collections-C/pull/119">Fix buffer overflow</a> (bug)</li><li><a href="https://github.com/srdja/Collections-C/pull/122">Remove the usage of cc_comp_ptr</a> (undefined behaviour)</li><li><a href="https://github.com/srdja/Collections-C/pull/123">Test coincidentally passing while they should not</a> (bugs and undefined behaviours)</li><li><a href="https://github.com/srdja/Collections-C/pull/125">Fix overallocation</a> (bug)</li><li><a href="https://github.com/srdja/Collections-C/pull/126">Fix hashing function</a> (performance-reducing bug)</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="reproducing-the-results-2"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#reproducing-the-results-2" title="Direct link to heading">#</a>Reproducing the Results</h4><p>For licensing reasons, we cannot include the Collections-C code in the Gillian repository.
There is an <a href="https://github.com/GillianPlatform/collections-c-for-gillian">external repository</a> that contains the Collections-C code adapted to testing in Gillian-C and KLEE.
In order to clone it, simply run, from the main Gillian folder:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-bash codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token builtin class-name" style="color:rgb(78, 201, 176)">cd</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">..</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">git</span><span class="token plain"> clone https://github.com/GillianPlatform/collections-c-for-gillian.git collections-c</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(78, 201, 176)">cd</span><span class="token plain"> Gillian</span></div></code></pre></div><p>There are two ways of launching the tests:</p><ul><li>Using the <code>bulk-wpst</code> command of Gillian-C which has a nicer output (using Rely), which only reports success/failure.</li><li>Using a bash script that will call <code>gillian-c wpst</code> as many times as there are files to test, but supports multi-threading and command counting.</li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="using-bulk-wpst"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#using-bulk-wpst" title="Direct link to heading">#</a>Using <code>bulk-wpst</code></h5><p>From the Gillian folder run:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-bash codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">esy x gillian-c bulk-wpst </span><span class="token punctuation" style="color:rgb(212, 212, 212)">..</span><span class="token plain">/collections-c/for-gillian</span></div></code></pre></div><p>You will see all of the test suites executing one by one. Two tests will fail, this is intended. They correspond to two of the bugs we have found and which are explained below.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="using-the-bash-script"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#using-the-bash-script" title="Direct link to heading">#</a>Using the <code>bash</code> script</h5><p>From the main Gillian folder, for each folder you would like to test, execute:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-bash codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">Gillian-C/scripts/testFolder.sh </span><span class="token punctuation" style="color:rgb(212, 212, 212)">..</span><span class="token plain">/collections-c/for-gillian/</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">folder</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span></div></code></pre></div><p>For example, to run the test suite related to singly-linked lists, execute:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-bash codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">Gillian-C/scripts/testFolder.sh </span><span class="token punctuation" style="color:rgb(212, 212, 212)">..</span><span class="token plain">/collections-c/for-gillian/slist</span></div></code></pre></div><p>As for Buckets.js, you can obtain the number of executed GIL commands for Collections-C by appending the <code>count</code> parameter to the testing command. For example, to count the number of executed commands for the singly-linked-list test suite, execute:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-bash codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">Gillian-C/scripts/testFolder.sh </span><span class="token punctuation" style="color:rgb(212, 212, 212)">..</span><span class="token plain">/collections-c/for-gillian/slist count</span></div></code></pre></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="notes-1"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#notes-1" title="Direct link to heading">#</a>Notes</h5><ol><li>The times obtained in the VM should be representative if run on a machine with a comparable specification (Intel Core i7-4980HQ CPU 2.80 GHz, DDR3 RAM 16GB, 256GB SSD) with no other applications running. Some (proportional) discrepancy is to be expected.</li><li>The times obtained when counting executed commands or using <code>bulk-wpst</code> will be slower, due to the fact that the tests will be run in single-threaded mode.</li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="the-array_test_removec-buffer-overflow-bug"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#the-array_test_removec-buffer-overflow-bug" title="Direct link to heading">#</a>The array_test_remove.c buffer overflow bug</h4><p>This test corresponds to <a href="https://github.com/srdja/Collections-C/pull/119">this</a> pull request.
It is particularly interesting, as the original concrete test suite does not catch it, even with the appropriate values. Instead, it overflows, but does not fail. This is, therefore, a <em>security issue</em>. On the other hand, our symbolic memory model does not allow for buffer overflow, and the bug was caught.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="the-list_test_zipiteraddc-flawed-test"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#the-list_test_zipiteraddc-flawed-test" title="Direct link to heading">#</a>The list_test_zipIterAdd.c flawed test</h4><p>This test is also interesting, but for different reasons: the code that it is testing (the <code>list_zip_iter_add</code> function) does not contain any bugs, it is the test that is buggy, but it still passes.</p><p>In particular, the test adds two elements (<code>&quot;h&quot;</code> and <code>&quot;i&quot;</code>) in two separate lists at index 2. It then tests that the elements actually appeared at the second index of their respective lists, in the following way:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-c codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">list_index_of</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">list1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;h&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> zero_if_ptr_eq</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain">index</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">CHECK_EQUAL_C_INT</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> index</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">list_index_of</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">list1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;i&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> zero_if_ptr_eq</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain">index</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">CHECK_EQUAL_C_INT</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> index</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></div></code></pre></div><p>However, note that both tests are executed on <code>list1</code>! What happened then is that <code>list_index_of</code> was not finding <code>&quot;i&quot;</code> in <code>list1</code> because it wasn&#x27;t there, and therefore did not modify <code>index</code>. Since the first check was correct, the value of <code>index</code> was still <code>2</code> and the test passed anyway.</p><p>Our symbolic tests however, use symbolic 1-character strings, and assumes <strong>the bare minimum about the input values</strong> to make them pass, in order to explore as many possible paths as possible.</p><p>Here, we replaced every one-character strings <code>&quot;X&quot;</code> with one-character symbolic string <code>str_X</code>. For the test to pass, it should be <em>enough</em> for <code>str_h</code> to be different from every element in <code>list1</code> and for <code>str_i</code> to be different from every element in <code>list2</code>, and this is exactly what we assumed. However, we never assumed that <code>str_i</code> has to be different from every element in <code>list1</code> because this is not necessary for the test to pass.</p><p>However, here, the equality between every element of <code>list1</code> and <code>str_i</code> is tested. There is no indication as to the result of this equality, and so the execution branches. Therefore, there is a path created where <code>list_index_of(list1, str_i, zero_if_ptr_eq, &amp;index)</code> will assign <code>0</code> to index, and the test will fail.</p><p>This shows how symbolic testing helps writing <em>more robust</em> tests.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="detailed-per-folder-breakdown-collections-c"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#detailed-per-folder-breakdown-collections-c" title="Direct link to heading">#</a>Detailed Per-Folder Breakdown: Collections-C</h4><table><thead><tr><th align="center"><strong>array</strong></th><th align="center"><strong>add</strong></th><th align="center"><strong>addAt2</strong></th><th align="center"><strong>contains</strong></th><th align="center"><strong>deepCopy</strong></th><th align="center"><strong>getAt</strong></th><th align="center"><strong>indexOf</strong></th><th align="center"><strong>iterAdd</strong></th><th align="center"><strong>iterRemove</strong></th><th align="center"><strong>iterReplace</strong></th><th align="center"><strong>reduce</strong></th><th align="center"><strong>remove</strong></th><th align="center"><strong>removeAll</strong></th><th align="center"><strong>removeAt</strong></th><th align="center"><strong>replaceAt</strong></th><th align="center"><strong>reverse</strong></th><th align="center"><strong>shallowCopy</strong></th><th align="center"><strong>subarray</strong></th><th align="center"><strong>zipIterAdd</strong></th><th align="center"><strong>zipIterNext</strong></th><th align="center"><strong>zipIterRemove</strong></th><th align="center"><strong>zipIterReplace</strong></th><th align="center"><strong>Total</strong></th></tr></thead><tbody><tr><td align="center"><strong>GIL Commands</strong></td><td align="center">1,779</td><td align="center">1,198</td><td align="center">4,122</td><td align="center">3,104</td><td align="center">1,794</td><td align="center">1,953</td><td align="center">4,419</td><td align="center">3,452</td><td align="center">4,158</td><td align="center">3,195</td><td align="center">22,373</td><td align="center">6,686</td><td align="center">2,011</td><td align="center">1,721</td><td align="center">2,033</td><td align="center">2,500</td><td align="center">3,021</td><td align="center">16,832</td><td align="center">14,301</td><td align="center">8,660</td><td align="center">14,065</td><td align="center">123,377</td></tr><tr><td align="center">Time (s)</td><td align="center">0.064</td><td align="center">0.070</td><td align="center">0.232</td><td align="center">0.070</td><td align="center">0.070</td><td align="center">0.073</td><td align="center">0.175</td><td align="center">0.147</td><td align="center">0.195</td><td align="center">0.083</td><td align="center">0.648</td><td align="center">0.644</td><td align="center">0.068</td><td align="center">0.089</td><td align="center">0.077</td><td align="center">0.085</td><td align="center">0.082</td><td align="center">0.801</td><td align="center">0.226</td><td align="center">0.291</td><td align="center">0.789</td><td align="center">4.979</td></tr><tr><td align="center"><strong>KLEE Time(s)</strong></td><td align="center">0.066</td><td align="center">0.095</td><td align="center">0.183</td><td align="center">0.104</td><td align="center">0.099</td><td align="center">0.092</td><td align="center">0.178</td><td align="center">0.152</td><td align="center">0.162</td><td align="center">0.094</td><td align="center">0.373</td><td align="center">0.293</td><td align="center">0.116</td><td align="center">0.114</td><td align="center">0.094</td><td align="center">0.115</td><td align="center">0.097</td><td align="center">0.961</td><td align="center">0.186</td><td align="center">0.437</td><td align="center">1.051</td><td align="center">5.062</td></tr></tbody></table><table><thead><tr><th align="center"><strong>deque</strong></th><th align="center"><strong>addAt1</strong></th><th align="center"><strong>addAt2</strong></th><th align="center"><strong>addAt3</strong></th><th align="center"><strong>addAt4</strong></th><th align="center"><strong>addAt5</strong></th><th align="center"><strong>addFirst</strong></th><th align="center"><strong>addLast</strong></th><th align="center"><strong>bufferExpansion</strong></th><th align="center"><strong>capacity</strong></th><th align="center"><strong>contains</strong></th><th align="center"><strong>copyDeep</strong></th><th align="center"><strong>copyShallow</strong></th><th align="center"><strong>filter1</strong></th><th align="center"><strong>filter2</strong></th><th align="center"><strong>filter3</strong></th><th align="center"><strong>filterMut1</strong></th><th align="center"><strong>filterMut2</strong></th><th align="center"><strong>filterMut3</strong></th><th align="center"><strong>getAt</strong></th><th align="center"><strong>getFirst</strong></th><th align="center"><strong>getLast</strong></th><th align="center"><strong>iterAdd</strong></th><th align="center"><strong>iterNext</strong></th><th align="center"><strong>iterRemove</strong></th><th align="center"><strong>removeAll</strong></th><th align="center"><strong>removeFirst</strong></th><th align="center"><strong>removeLast</strong></th><th align="center"><strong>reverse</strong></th><th align="center"><strong>size</strong></th><th align="center"><strong>trimCapacity</strong></th><th align="center"><strong>zipIterAdd</strong></th><th align="center"><strong>zipIterNext</strong></th><th align="center"><strong>zipIterRemove</strong></th><th align="center"><strong>zipIterReplace</strong></th><th align="center"><strong>Total</strong></th></tr></thead><tbody><tr><td align="center"><strong>GIL Commands</strong></td><td align="center">3,216</td><td align="center">3,284</td><td align="center">3,466</td><td align="center">3,293</td><td align="center">3,291</td><td align="center">2,112</td><td align="center">2,062</td><td align="center">3,592</td><td align="center">3,406</td><td align="center">6,055</td><td align="center">3,947</td><td align="center">2,867</td><td align="center">6,316</td><td align="center">6,314</td><td align="center">5,646</td><td align="center">6,274</td><td align="center">6,121</td><td align="center">6,311</td><td align="center">2,032</td><td align="center">1,885</td><td align="center">1,921</td><td align="center">6,781</td><td align="center">6,710</td><td align="center">6,863</td><td align="center">2,054</td><td align="center">2,486</td><td align="center">2,549</td><td align="center">2,587</td><td align="center">2,091</td><td align="center">2,444</td><td align="center">17,745</td><td align="center">21,656</td><td align="center">15,485</td><td align="center">13,765</td><td align="center">186,627</td></tr><tr><td align="center"><strong>Time(s)</strong></td><td align="center">0.083</td><td align="center">0.091</td><td align="center">0.096</td><td align="center">0.089</td><td align="center">0.089</td><td align="center">0.093</td><td align="center">0.094</td><td align="center">0.096</td><td align="center">0.093</td><td align="center">0.100</td><td align="center">0.096</td><td align="center">0.108</td><td align="center">0.303</td><td align="center">0.296</td><td align="center">0.266</td><td align="center">0.276</td><td align="center">0.284</td><td align="center">0.273</td><td align="center">0..092</td><td align="center">0.097</td><td align="center">0.097</td><td align="center">0.234</td><td align="center">0.237</td><td align="center">0.216</td><td align="center">0.077</td><td align="center">0.096</td><td align="center">0.090</td><td align="center">0.094</td><td align="center">0.094</td><td align="center">0.093</td><td align="center">0.262</td><td align="center">0.352</td><td align="center">0.261</td><td align="center">0.257</td><td align="center">5.383</td></tr><tr><td align="center"><strong>KLEE Time(s)</strong></td><td align="center">0.116</td><td align="center">0.104</td><td align="center">0.113</td><td align="center">0.116</td><td align="center">0.125</td><td align="center">0.118</td><td align="center">0.117</td><td align="center">0.132</td><td align="center">0.111</td><td align="center">0.123</td><td align="center">0.127</td><td align="center">0.116</td><td align="center">0.152</td><td align="center">0.651</td><td align="center">0.169</td><td align="center">0.135</td><td align="center">0.143</td><td align="center">0.143</td><td align="center">0.100</td><td align="center">0.101</td><td align="center">0.134</td><td align="center">0.208</td><td align="center">0.174</td><td align="center">0.181</td><td align="center">0.111</td><td align="center">0.086</td><td align="center">0.114</td><td align="center">0.106</td><td align="center">0.109</td><td align="center">0.133</td><td align="center">0.300</td><td align="center">0.259</td><td align="center">0.307</td><td align="center">0.281</td><td align="center">5.515</td></tr></tbody></table><table><thead><tr><th align="center"><strong>list</strong></th><th align="center"><strong>add</strong></th><th align="center"><strong>addAll</strong></th><th align="center"><strong>addAllAt</strong></th><th align="center"><strong>addAt</strong></th><th align="center"><strong>addFirst</strong></th><th align="center"><strong>addLast</strong></th><th align="center"><strong>contains</strong></th><th align="center"><strong>copyDeep</strong></th><th align="center"><strong>copyShallow</strong></th><th align="center"><strong>filter1</strong></th><th align="center"><strong>filter2</strong></th><th align="center"><strong>getAt</strong></th><th align="center"><strong>getLast</strong></th><th align="center"><strong>indexOf</strong></th><th align="center"><strong>iterAdd</strong></th><th align="center"><strong>iterDescAdd</strong></th><th align="center"><strong>iterDescRemove</strong></th><th align="center"><strong>iterRemove</strong></th><th align="center"><strong>mutFilter1</strong></th><th align="center"><strong>mutFilter2</strong></th><th align="center"><strong>new</strong></th><th align="center"><strong>remove</strong></th><th align="center"><strong>removeAll</strong></th><th align="center"><strong>removeAt</strong></th><th align="center"><strong>removeFirst</strong></th><th align="center"><strong>removeLast</strong></th><th align="center"><strong>replaceAt</strong></th><th align="center"><strong>reverse</strong></th><th align="center"><strong>splice</strong></th><th align="center"><strong>spliceAt</strong></th><th align="center"><strong>sublist</strong></th><th align="center"><strong>toArray</strong></th><th align="center"><strong>zipIterAdd</strong></th><th align="center"><strong>zipIterNext</strong></th><th align="center"><strong>zipIterRemove</strong></th><th align="center"><strong>zipIterReplace</strong></th><th align="center"><strong>Total</strong></th></tr></thead><tbody><tr><td align="center"><strong>GIL Commands</strong></td><td align="center">5,011</td><td align="center">12,107</td><td align="center">13,006</td><td align="center">9,751</td><td align="center">5,578</td><td align="center">5,578</td><td align="center">8,713</td><td align="center">14,109</td><td align="center">13,415</td><td align="center">9,884</td><td align="center">10,313</td><td align="center">8,485</td><td align="center">8,273</td><td align="center">5,849</td><td align="center">13,998</td><td align="center">12,907</td><td align="center">10,595</td><td align="center">10,292</td><td align="center">8,672</td><td align="center">8,976</td><td align="center">1,602</td><td align="center">9,380</td><td align="center">8,513</td><td align="center">9,287</td><td align="center">8,321</td><td align="center">8,331</td><td align="center">8,958</td><td align="center">10,145</td><td align="center">9,693</td><td align="center">9,619</td><td align="center">11,586</td><td align="center">10,425</td><td align="center">70,782</td><td align="center">64,043</td><td align="center">23,793</td><td align="center">18,783</td><td align="center">478,773</td></tr><tr><td align="center"><strong>Time(s)</strong></td><td align="center">0.103</td><td align="center">0.111</td><td align="center">0.109</td><td align="center">0.100</td><td align="center">0.110</td><td align="center">0.110</td><td align="center">0.365</td><td align="center">0.108</td><td align="center">0.119</td><td align="center">0.203</td><td align="center">0.250</td><td align="center">0.104</td><td align="center">0.102</td><td align="center">0.245</td><td align="center">0.262</td><td align="center">0.225</td><td align="center">0.237</td><td align="center">0.186</td><td align="center">0.193</td><td align="center">0.242</td><td align="center">0.078</td><td align="center">0.124</td><td align="center">0.109</td><td align="center">0.105</td><td align="center">0.093</td><td align="center">0.110</td><td align="center">0.110</td><td align="center">0.105</td><td align="center">0.106</td><td align="center">0.112</td><td align="center">0.111</td><td align="center">0.106</td><td align="center">1.033</td><td align="center">0.262</td><td align="center">0.763</td><td align="center">0.609</td><td align="center">7.420</td></tr><tr><td align="center"><strong>KLEE Time(s)</strong></td><td align="center">0.117</td><td align="center">0.128</td><td align="center">0.110</td><td align="center">0.130</td><td align="center">0.099</td><td align="center">0.105</td><td align="center">0.256</td><td align="center">0.129</td><td align="center">0.146</td><td align="center">0.178</td><td align="center">0.175</td><td align="center">0.118</td><td align="center">0.139</td><td align="center">0.200</td><td align="center">0.234</td><td align="center">0.133</td><td align="center">0.211</td><td align="center">0.174</td><td align="center">0.176</td><td align="center">0.169</td><td align="center">0.100</td><td align="center">0.175</td><td align="center">0.123</td><td align="center">0.120</td><td align="center">0.118</td><td align="center">0.104</td><td align="center">0.114</td><td align="center">0.126</td><td align="center">0.125</td><td align="center">0.146</td><td align="center">0.120</td><td align="center">0.109</td><td align="center">0.998</td><td align="center">0.208</td><td align="center">0.575</td><td align="center">0.487</td><td align="center">6.875</td></tr></tbody></table><table><thead><tr><th align="center"><strong>pqueue</strong></th><th align="center"><strong>enqueue</strong></th><th align="center"><strong>pop</strong></th><th align="center"><strong>Total</strong></th></tr></thead><tbody><tr><td align="center"><strong>GIL Commands</strong></td><td align="center">10,684</td><td align="center">5,042</td><td align="center">15,726</td></tr><tr><td align="center"><strong>Time(s)</strong></td><td align="center">0.278</td><td align="center">0.290</td><td align="center">0.568</td></tr><tr><td align="center"><strong>KLEE Time(s)</strong></td><td align="center">0.118</td><td align="center">0.128</td><td align="center">0.246</td></tr></tbody></table><table><thead><tr><th align="center"><strong>queue</strong></th><th align="center"><strong>enqueue</strong></th><th align="center"><strong>iter</strong></th><th align="center"><strong>poll</strong></th><th align="center"><strong>zipIterNext</strong></th><th align="center"><strong>Total</strong></th></tr></thead><tbody><tr><td align="center"><strong>GIL Commands</strong></td><td align="center">4,268</td><td align="center">5,736</td><td align="center">4,799</td><td align="center">24,675</td><td align="center">39,478</td></tr><tr><td align="center"><strong>Time(s)</strong></td><td align="center">0.075</td><td align="center">0.082</td><td align="center">0.081</td><td align="center">0.236</td><td align="center">0.474</td></tr><tr><td align="center"><strong>KLEE Time(s)</strong></td><td align="center">0.104</td><td align="center">0.087</td><td align="center">0.102</td><td align="center">0.169</td><td align="center">0.463</td></tr></tbody></table><table><thead><tr><th align="center"><strong>ring_buffer</strong></th><th align="center"><strong>capacity</strong></th><th align="center"><strong>enqueue</strong></th><th align="center"><strong>dequeue</strong></th><th align="center"><strong>Total</strong></th></tr></thead><tbody><tr><td align="center"><strong>GIL Commands</strong></td><td align="center">8,361</td><td align="center">10,495</td><td align="center">8,428</td><td align="center">27,284</td></tr><tr><td align="center"><strong>Time(s)</strong></td><td align="center">0.084</td><td align="center">0.077</td><td align="center">0.075</td><td align="center">0.236</td></tr><tr><td align="center"><strong>KLEE Time(s)</strong></td><td align="center">0.105</td><td align="center">0.103</td><td align="center">0.111</td><td align="center">0.319</td></tr></tbody></table><table><thead><tr><th align="center"><strong>slist</strong></th><th align="center"><strong>add</strong></th><th align="center"><strong>addAll</strong></th><th align="center"><strong>addAllAt</strong></th><th align="center"><strong>addAt</strong></th><th align="center"><strong>addFirst</strong></th><th align="center"><strong>addLast</strong></th><th align="center"><strong>contains</strong></th><th align="center"><strong>copyDeep</strong></th><th align="center"><strong>copyShallow</strong></th><th align="center"><strong>filter1</strong></th><th align="center"><strong>filter2</strong></th><th align="center"><strong>filter3</strong></th><th align="center"><strong>filterMut1</strong></th><th align="center"><strong>filterMut2</strong></th><th align="center"><strong>filterMut3</strong></th><th align="center"><strong>get</strong></th><th align="center"><strong>getFirst</strong></th><th align="center"><strong>getLast</strong></th><th align="center"><strong>indexOf</strong></th><th align="center"><strong>iterAdd</strong></th><th align="center"><strong>iterRemove</strong></th><th align="center"><strong>new</strong></th><th align="center"><strong>remove</strong></th><th align="center"><strong>removeAll</strong></th><th align="center"><strong>removeAt</strong></th><th align="center"><strong>removeFirst</strong></th><th align="center"><strong>removeLast</strong></th><th align="center"><strong>replaceAt</strong></th><th align="center"><strong>reverse</strong></th><th align="center"><strong>splice</strong></th><th align="center"><strong>spliceAt</strong></th><th align="center"><strong>sublist</strong></th><th align="center"><strong>toArray</strong></th><th align="center"><strong>zipIterAdd</strong></th><th align="center"><strong>zipIterNext</strong></th><th align="center"><strong>zipIterRemove</strong></th><th align="center"><strong>zipIterReplace</strong></th><th align="center"><strong>Total</strong></th></tr></thead><tbody><tr><td align="center"><strong>GIL Commands</strong></td><td align="center">3,842</td><td align="center">7,733</td><td align="center">8,882</td><td align="center">8,283</td><td align="center">4,085</td><td align="center">4,085</td><td align="center">5,664</td><td align="center">10,221</td><td align="center">9,743</td><td align="center">7,106</td><td align="center">8,597</td><td align="center">10,889</td><td align="center">6,587</td><td align="center">7,467</td><td align="center">6,554</td><td align="center">5,765</td><td align="center">5,585</td><td align="center">5,585</td><td align="center">3,918</td><td align="center">11,395</td><td align="center">8,028</td><td align="center">2,272</td><td align="center">6,899</td><td align="center">5,925</td><td align="center">6,836</td><td align="center">5,809</td><td align="center">6,166</td><td align="center">6,294</td><td align="center">7,097</td><td align="center">6,401</td><td align="center">6,638</td><td align="center">8,270</td><td align="center">7,124</td><td align="center">98,888</td><td align="center">36,774</td><td align="center">39,558</td><td align="center">14,340</td><td align="center">415,305</td></tr><tr><td align="center"><strong>Time(s)</strong></td><td align="center">0.112</td><td align="center">0.118</td><td align="center">0.117</td><td align="center">0.118</td><td align="center">0.110</td><td align="center">0.112</td><td align="center">0.114</td><td align="center">0.120</td><td align="center">0.117</td><td align="center">0.227</td><td align="center">0.283</td><td align="center">0.291</td><td align="center">0.231</td><td align="center">0.284</td><td align="center">0.285</td><td align="center">0.115</td><td align="center">0.114</td><td align="center">0.112</td><td align="center">0.109</td><td align="center">0.297</td><td align="center">0.221</td><td align="center">0.110</td><td align="center">0.205</td><td align="center">0.113</td><td align="center">0.115</td><td align="center">0.114</td><td align="center">0.115</td><td align="center">0.112</td><td align="center">0.117</td><td align="center">0.115</td><td align="center">0.114</td><td align="center">0.116</td><td align="center">0.114</td><td align="center">0.830</td><td align="center">0.281</td><td align="center">0.617</td><td align="center">0.513</td><td align="center">7.308</td></tr><tr><td align="center"><strong>KLEE Time(s)</strong></td><td align="center">0.118</td><td align="center">0.133</td><td align="center">0.126</td><td align="center">0.132</td><td align="center">0.127</td><td align="center">0.109</td><td align="center">0.125</td><td align="center">0.126</td><td align="center">0.132</td><td align="center">0.184</td><td align="center">0.151</td><td align="center">0.163</td><td align="center">0.138</td><td align="center">0.152</td><td align="center">0.131</td><td align="center">0.119</td><td align="center">0.113</td><td align="center">0.122</td><td align="center">0.097</td><td align="center">0.125</td><td align="center">0.179</td><td align="center">0.110</td><td align="center">0.154</td><td align="center">0.107</td><td align="center">0.131</td><td align="center">0.138</td><td align="center">0.115</td><td align="center">0.148</td><td align="center">0.130</td><td align="center">0.117</td><td align="center">0.116</td><td align="center">0.109</td><td align="center">0.128</td><td align="center">1.169</td><td align="center">0.195</td><td align="center">0.659</td><td align="center">0.406</td><td align="center">6.732</td></tr></tbody></table><table><thead><tr><th align="center"><strong>stack</strong></th><th align="center"><strong>pop</strong></th><th align="center"><strong>push</strong></th><th align="center"><strong>Total</strong></th></tr></thead><tbody><tr><td align="center"><strong>GIL Commands</strong></td><td align="center">2,539</td><td align="center">2,672</td><td align="center">5,211</td></tr><tr><td align="center"><strong>Time(s)</strong></td><td align="center">0.109</td><td align="center">0.107</td><td align="center">0.216</td></tr><tr><td align="center"><strong>KLEE Time(s)</strong></td><td align="center">0.105</td><td align="center">0.103</td><td align="center">0.208</td></tr></tbody></table><table><thead><tr><th align="center"><strong>treeset</strong></th><th align="center"><strong>add</strong></th><th align="center"><strong>iterNext</strong></th><th align="center"><strong>iterRemove</strong></th><th align="center"><strong>remove</strong></th><th align="center"><strong>removeAll</strong></th><th align="center"><strong>size</strong></th><th align="center"><strong>Total</strong></th></tr></thead><tbody><tr><td align="center"><strong>GIL Commands</strong></td><td align="center">18,586</td><td align="center">9,195</td><td align="center">31,648</td><td align="center">19,323</td><td align="center">18,625</td><td align="center">11,206</td><td align="center">108,583</td></tr><tr><td align="center"><strong>Time(s)</strong></td><td align="center">0.287</td><td align="center">0.347</td><td align="center">0.293</td><td align="center">0.290</td><td align="center">0.292</td><td align="center">0.291</td><td align="center">1.800</td></tr><tr><td align="center"><strong>KLEE Time(s)</strong></td><td align="center">0.458</td><td align="center">0.462</td><td align="center">0.402</td><td align="center">0.434</td><td align="center">0.349</td><td align="center">0.325</td><td align="center">2.430</td></tr></tbody></table><table><thead><tr><th align="center"><strong>treetable</strong></th><th align="center"><strong>add</strong></th><th align="center"><strong>get</strong></th><th align="center"><strong>getFirst</strong></th><th align="center"><strong>getGreaterThan</strong></th><th align="center"><strong>getLast</strong></th><th align="center"><strong>getLessThan</strong></th><th align="center"><strong>iterNext</strong></th><th align="center"><strong>iterRemove</strong></th><th align="center"><strong>remove</strong></th><th align="center"><strong>removeAll</strong></th><th align="center"><strong>removeFirst</strong></th><th align="center"><strong>removeLast</strong></th><th align="center"><strong>size</strong></th><th align="center"><strong>Total</strong></th></tr></thead><tbody><tr><td align="center"><strong>GIL Commands</strong></td><td align="center">29,759</td><td align="center">9,511</td><td align="center">5,800</td><td align="center">6,228</td><td align="center">5,734</td><td align="center">6,193</td><td align="center">9,252</td><td align="center">7,876</td><td align="center">25,949</td><td align="center">27,219</td><td align="center">6,481</td><td align="center">7,291</td><td align="center">15,315</td><td align="center">162,608</td></tr><tr><td align="center"><strong>Time(s)</strong></td><td align="center">0.356</td><td align="center">0.205</td><td align="center">0.231</td><td align="center">0.229</td><td align="center">0.236</td><td align="center">0.225</td><td align="center">0.331</td><td align="center">0.248</td><td align="center">0.280</td><td align="center">0.283</td><td align="center">0.224</td><td align="center">0.274</td><td align="center">0.274</td><td align="center">3.396</td></tr><tr><td align="center"><strong>KLEE Time(s)</strong></td><td align="center">0.474</td><td align="center">0.158</td><td align="center">0.192</td><td align="center">0.182</td><td align="center">0.192</td><td align="center">0.182</td><td align="center">0.368</td><td align="center">0.225</td><td align="center">0.384</td><td align="center">0.293</td><td align="center">0.193</td><td align="center">0.221</td><td align="center">0.316</td><td align="center">3.380</td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="from-theory-to-implementation"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#from-theory-to-implementation" title="Direct link to heading">#</a>From Theory to Implementation</h2><p>In the paper, the formalisation of GIL and the associated meta-theory is streamlined for clarity.
The implementation follows the same principles, but is, expectedly, more complex.
Here, we outline the main differences.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="gil-syntax-and-semantics"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#gil-syntax-and-semantics" title="Direct link to heading">#</a>GIL Syntax and Semantics</h3><p>The syntax of GIL is defined in the paper on page 2, in the display box spanning lines 166-172.</p><p>We first focus on commands, which are defined in the implementation <a href="https://github.com/GillianPlatform/Gillian/blob/PLDI20/GillianCore/GIL_Syntax/Cmd.ml">in the <code>Cmd.ml</code> file</a> as follows:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-ocaml codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">(* Cmd.ml *)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">type</span><span class="token plain"> </span><span class="token type variable" style="color:rgb(156, 220, 254)">&#x27;label</span><span class="token plain"> t </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> Skip                                                                      </span><span class="token comment" style="color:rgb(106, 153, 85)">(** Skip                              *)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> Assignment    </span><span class="token keyword" style="color:rgb(86, 156, 214)">of</span><span class="token plain"> string </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> Expr</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">t                                          </span><span class="token comment" style="color:rgb(106, 153, 85)">(** Assignment                        *)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> LAction       </span><span class="token keyword" style="color:rgb(86, 156, 214)">of</span><span class="token plain"> string </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> string </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> Expr</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">t list                            </span><span class="token comment" style="color:rgb(106, 153, 85)">(** Local Actions                     *)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> Logic         </span><span class="token keyword" style="color:rgb(86, 156, 214)">of</span><span class="token plain"> LCmd</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">t                                                   </span><span class="token comment" style="color:rgb(106, 153, 85)">(** GIL Logic commands                *)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> Goto          </span><span class="token keyword" style="color:rgb(86, 156, 214)">of</span><span class="token plain"> </span><span class="token type variable" style="color:rgb(156, 220, 254)">&#x27;label</span><span class="token plain">                                                   </span><span class="token comment" style="color:rgb(106, 153, 85)">(** Unconditional goto                *)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> GuardedGoto   </span><span class="token keyword" style="color:rgb(86, 156, 214)">of</span><span class="token plain"> Expr</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">t </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> </span><span class="token type variable" style="color:rgb(156, 220, 254)">&#x27;label</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> </span><span class="token type variable" style="color:rgb(156, 220, 254)">&#x27;label</span><span class="token plain">                                 </span><span class="token comment" style="color:rgb(106, 153, 85)">(** Conditional goto                  *)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> Call          </span><span class="token keyword" style="color:rgb(86, 156, 214)">of</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      string </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> Expr</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">t </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> Expr</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">t list </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> </span><span class="token type variable" style="color:rgb(156, 220, 254)">&#x27;label</span><span class="token plain"> option </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> logic</span><span class="token punctuation" style="color:rgb(212, 212, 212)">_</span><span class="token plain">bindings</span><span class="token punctuation" style="color:rgb(212, 212, 212)">_</span><span class="token plain">t option </span><span class="token comment" style="color:rgb(106, 153, 85)">(** Procedure call                    *)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> ECall         </span><span class="token keyword" style="color:rgb(86, 156, 214)">of</span><span class="token plain"> string </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> Expr</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">t </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> Expr</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">t list </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> </span><span class="token type variable" style="color:rgb(156, 220, 254)">&#x27;label</span><span class="token plain"> option            </span><span class="token comment" style="color:rgb(106, 153, 85)">(** External Procedure call           *)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> Apply         </span><span class="token keyword" style="color:rgb(86, 156, 214)">of</span><span class="token plain"> string </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> Expr</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">t </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> </span><span class="token type variable" style="color:rgb(156, 220, 254)">&#x27;label</span><span class="token plain"> option                          </span><span class="token comment" style="color:rgb(106, 153, 85)">(** Application-style procedure call  *)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> Arguments     </span><span class="token keyword" style="color:rgb(86, 156, 214)">of</span><span class="token plain"> string                                                   </span><span class="token comment" style="color:rgb(106, 153, 85)">(** Arguments of the current function *)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> PhiAssignment </span><span class="token keyword" style="color:rgb(86, 156, 214)">of</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">string </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> Expr</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">t list</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> list                              </span><span class="token comment" style="color:rgb(106, 153, 85)">(** PHI assignment                    *)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> ReturnNormal                                                              </span><span class="token comment" style="color:rgb(106, 153, 85)">(** Normal return                     *)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> ReturnError                                                               </span><span class="token comment" style="color:rgb(106, 153, 85)">(** Error return                      *)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> Fail          </span><span class="token keyword" style="color:rgb(86, 156, 214)">of</span><span class="token plain"> string </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> Expr</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">t list                                     </span><span class="token comment" style="color:rgb(106, 153, 85)">(** Failure                           *)</span></div></code></pre></div><p>The differences are as follows:</p><ul><li>The <code>Skip</code> command does nothing. It is useful as a collection point for PHI-nodes, see below.</li><li>Action execution, <code>LAction (x, a, [e1, ..., en])</code> (corresponding to <code>x := a(e1, ..., en)</code>) takes multiple parameters instead of one, and actions themselves are represented as strings.</li><li>There are two <code>goto commands</code>:<ul><li><code>Goto lab</code> that jumps unconditionally to the label <code>lab</code>; and</li><li><code>GuardedGoto(e, lab1, lab2)</code> that jumps to <code>lab1</code> if <code>e</code> evaluates to <code>true</code> or to <code>lab2</code> if it evaluates to <code>false</code>
The <code>ifgoto</code> presented in the paper is equivalent to these two commands.</li></ul></li><li>In the implementation, commands can be annotated with string labels (<code>string Cmd.t</code>); in the paper, they are assigned integer indexes (<code>int Cmd.t</code>).
We write GIL programs with labeled commands for readability, and transpile to indexed commands for efficiency.</li><li>In addition to the <code>return</code> (<code>ReturnNormal</code>) command, there is also a <code>throw</code> (<code>ReturnError</code>) command.
This is because GIL execution has three modes in the implementation: normal, error, and failure.
The error mode allows us to handle exceptions, but only clutters the meta-theory. For more details, see [JaVerT 2.0].</li><li>The procedure call <code>Call(x, e, [e1, ..., en], lab)</code> (corresponding to <code>x := e(e1, ..., en) with lab</code>) takes multiple parameters instead of one, and,
if the execution of the procedure terminates in error mode, the execution proceeds to the label <code>lab</code> automatically.
The optional logical bindings are out of scope for this paper.</li><li>We allow procedures to have a variable number of arguments using the <code>Apply</code> and <code>Arguments</code> commands.
The <code>Apply(x, e, lab)</code> command, corresponding to <code>x := apply(e)</code>, expects <code>e</code> to be a GIL list, whose first element is the procedure name, and the remaining elements are the parameters with which the procedure is to be called. The <code>Arguments</code> command returns the list of parameters with which the procedure was called.</li><li>The implementation also has an external call mechanism, <code>ECall</code>, that is currently used to model the <code>eval</code> statement in JavaScript, and could be used to model some system calls in Gillian-C. For more details, see [JaVerT 2.0].</li><li>We have the multi-variable phi-assignment, <code>PhiAssignment</code>, that allows us to write programs in Single Static Assignment (SSA). JS-2-JSIL, for example, outputs code in SSA.
For more details, see [JaVerT].</li><li>The <code>Fail</code> command (<code>fail [desc] (e1, ..., en)</code>) can return multiple values and also carries a string that may contain an error name or error message.</li><li>The <code>vanish</code> command of the paper has, incidentally, vanished. Instead, we have two higher-level commands, <code>assume</code> and <code>assert</code> in the <a href="https://github.com/GillianPlatform/Gillian/blob/PLDI20/GillianCore/GIL_Syntax/LCmd.ml">logic commands</a>, together with other logic commands that are out of scope of this paper. The <code>assume</code>/<code>assert</code> mechanism is equivalent to the <code>ifgoto-vanish/ifgoto-fail</code> mechanisms of the paper.</li><li>The <code>uSym</code> and <code>iSym</code> commands are mainly theoretical devices that ensure soundness in the presence of fresh-value generation.
In the implementation, we provide an allocation mechanism that allows the creators of Gillian instantiations to generate fresh interpreted and uninterpreted symbols.
They can then expose two dedicated actions corresponding to <code>uSym</code> and <code>iSym</code>.</li></ul><p>The procedures and programs also contain more information than given in the paper:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-ocaml codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">type</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token type variable" style="color:rgb(156, 220, 254)">&#x27;annot</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token type variable" style="color:rgb(156, 220, 254)">&#x27;label</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> proc </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  proc</span><span class="token punctuation" style="color:rgb(212, 212, 212)">_</span><span class="token plain">name </span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> string</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  proc</span><span class="token punctuation" style="color:rgb(212, 212, 212)">_</span><span class="token plain">body </span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token type variable" style="color:rgb(156, 220, 254)">&#x27;annot</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> </span><span class="token type variable" style="color:rgb(156, 220, 254)">&#x27;label</span><span class="token plain"> option </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> </span><span class="token type variable" style="color:rgb(156, 220, 254)">&#x27;label</span><span class="token plain"> Cmd</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">t</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> array</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  proc</span><span class="token punctuation" style="color:rgb(212, 212, 212)">_</span><span class="token plain">params </span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> string list</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  proc</span><span class="token punctuation" style="color:rgb(212, 212, 212)">_</span><span class="token plain">spec </span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">t option</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">type</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token type variable" style="color:rgb(156, 220, 254)">&#x27;annot</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token type variable" style="color:rgb(156, 220, 254)">&#x27;label</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> prog </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  imports </span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> string list</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  lemmas </span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">string</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> Lemma</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">t</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> Hashtbl</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">t</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  preds </span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">string</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> Pred</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">t</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> Hashtbl</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">t</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  only</span><span class="token punctuation" style="color:rgb(212, 212, 212)">_</span><span class="token plain">specs </span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">string</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> Spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">t</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> Hashtbl</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">t</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  procs </span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">string</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token type variable" style="color:rgb(156, 220, 254)">&#x27;annot</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token type variable" style="color:rgb(156, 220, 254)">&#x27;label</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> Proc</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">t</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> Hashtbl</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">t</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  macros </span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">string</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> Macro</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">t</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> Hashtbl</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">t</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  bi</span><span class="token punctuation" style="color:rgb(212, 212, 212)">_</span><span class="token plain">specs </span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">string</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> BiSpec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">t</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> Hashtbl</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">t</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  proc</span><span class="token punctuation" style="color:rgb(212, 212, 212)">_</span><span class="token plain">names </span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> string list</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  predecessors </span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">string </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> int </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> int</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> int</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> Hashtbl</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">t</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span></div></code></pre></div><p>Procedures have a name, a body and parameters as described in the paper. However, each command in the body is also annotated with an opaque value that can be decided by the user (it has the <code>&#x27;annot</code> polymorphic type). These annotations can be used, for example, to hold information that helps error reporting, such as the line number of the command of the target language to which a given GIL line corresponds. Every command can also be attached to a label, that has the polymorphic type <code>&#x27;label</code>. Most often, we use <code>string</code> labels for labeled programs and <code>int</code> labels for indexed programs, as explained above. Finally, procedures can also have specifications that are used for verification and automatic compositional testing (out of scope).</p><p>Programs are not just maps from procedure identifiers to procedures, and additionally include, primarily, per-function verification-related information,
as well as a list of <code>imports</code> that need to be included on execution, the list of all procedure identifiers, and a table of predecessors required for
the PHI-assignment to work properly.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="allocators"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#allocators" title="Direct link to heading">#</a>Allocators</h3><p>In the paper, allocators are defined near the end of page 3 (from line 320). They could be interpreted in terms of OCaml module signature as follows:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-ocaml codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">module</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">type</span><span class="token plain"> Allocator </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">sig</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">type</span><span class="token plain"> t    </span><span class="token comment" style="color:rgb(106, 153, 85)">(** Type of allocation records    *)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">type</span><span class="token plain"> us</span><span class="token punctuation" style="color:rgb(212, 212, 212)">_</span><span class="token plain">t </span><span class="token comment" style="color:rgb(106, 153, 85)">(** Type of uninterpreted symbols *)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">type</span><span class="token plain"> is</span><span class="token punctuation" style="color:rgb(212, 212, 212)">_</span><span class="token plain">t </span><span class="token comment" style="color:rgb(106, 153, 85)">(** Type of interpreted symbols   *)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">val</span><span class="token plain"> alloc</span><span class="token punctuation" style="color:rgb(212, 212, 212)">_</span><span class="token plain">us </span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> t </span><span class="token operator" style="color:rgb(212, 212, 212)">-&gt;</span><span class="token plain"> int </span><span class="token operator" style="color:rgb(212, 212, 212)">-&gt;</span><span class="token plain"> t </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> us</span><span class="token punctuation" style="color:rgb(212, 212, 212)">_</span><span class="token plain">t</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">val</span><span class="token plain"> alloc</span><span class="token punctuation" style="color:rgb(212, 212, 212)">_</span><span class="token plain">is </span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> t </span><span class="token operator" style="color:rgb(212, 212, 212)">-&gt;</span><span class="token plain"> int </span><span class="token operator" style="color:rgb(212, 212, 212)">-&gt;</span><span class="token plain"> t </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> is</span><span class="token punctuation" style="color:rgb(212, 212, 212)">_</span><span class="token plain">t</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span></div></code></pre></div><p>For efficiency, however, we chose to have this implementation:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-ocaml codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">(* Allocator.ml *)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">module</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">type</span><span class="token plain"> S </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">sig</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">type</span><span class="token plain"> t                   </span><span class="token comment" style="color:rgb(106, 153, 85)">(** Type of value to allocate *)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">val</span><span class="token plain"> alloc </span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> unit </span><span class="token operator" style="color:rgb(212, 212, 212)">-&gt;</span><span class="token plain"> t    </span><span class="token comment" style="color:rgb(106, 153, 85)">(** Allocation function *)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">val</span><span class="token plain"> dealloc </span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> t </span><span class="token operator" style="color:rgb(212, 212, 212)">-&gt;</span><span class="token plain"> unit  </span><span class="token comment" style="color:rgb(106, 153, 85)">(** Deallocation function *)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">val</span><span class="token plain"> eq </span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> t </span><span class="token operator" style="color:rgb(212, 212, 212)">-&gt;</span><span class="token plain"> t </span><span class="token operator" style="color:rgb(212, 212, 212)">-&gt;</span><span class="token plain"> bool  </span><span class="token comment" style="color:rgb(106, 153, 85)">(** Equality of values to allocate *)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">val</span><span class="token plain"> reset </span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> unit </span><span class="token operator" style="color:rgb(212, 212, 212)">-&gt;</span><span class="token plain"> unit </span><span class="token comment" style="color:rgb(106, 153, 85)">(** Reset this allocator *)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span></div></code></pre></div><p>The <code>dealloc</code> function allows for de-allocation of values.
The <code>reset</code> function is useful for bulk-testing; when running a new test, all allocators are reset.</p><p>The abstract location allocator (in <a href="https://github.com/GillianPlatform/Gillian/blob/PLDI20/GillianCore/GIL_Syntax/ALoc.ml"><code>ALoc.ml</code></a>), which corresponds to uninterpreted symbols, is then initialised as follows:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-ocaml codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">include</span><span class="token plain"> Allocators</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Make</span><span class="token punctuation" style="color:rgb(212, 212, 212)">_</span><span class="token plain">with</span><span class="token punctuation" style="color:rgb(212, 212, 212)">_</span><span class="token plain">prefix</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">Basic </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">struct</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token keyword" style="color:rgb(86, 156, 214)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">prefix</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Names</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">aloc</span><span class="token punctuation" style="color:rgb(212, 212, 212)">_</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token keyword" style="color:rgb(86, 156, 214)">end</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span></div></code></pre></div><p>Where <code>Make_with_prefix</code> is a functor that takes:</p><ul><li>An abstract allocator <code>AL</code>, which produces values that can be stringified.</li><li>A string prefix</li></ul><p>and it returns an Allocator that allocates strings of the form <code>PREFIX_A</code> where <code>PREFIX</code> is the given prefix and <code>A</code> is the stringification of the value allocated by <code>AL</code>.</p><p>In the <code>ALoc</code> case, as the <code>AL</code> parameter, we use <code>Basic ()</code>, which instantiates an abstract allocator module that internally allocates integers. We show how allocators can be used in practice shortly.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="the-state-model-interface"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#the-state-model-interface" title="Direct link to heading">#</a>The State Model interface</h3><p>In the paper, the state model interface is defined in line 208 and proper state models are defined in line 248 in terms of actions they must implement.
In the implementation, the interface of state models, available in <a href="https://github.com/GillianPlatform/Gillian/blob/PLDI20/GillianCore/engine/GeneralSemantics/State.ml"><code>State.ml</code></a> is slightly different and more complex. Most importantly, the actions are not infinite indexed families, and the index is normally the parameter of the action.</p><p>For example, the signature of expression evaluation, <code>eval_expr</code> is as follows:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-ocaml codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">val</span><span class="token plain"> eval</span><span class="token punctuation" style="color:rgb(212, 212, 212)">_</span><span class="token plain">expr </span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> t </span><span class="token operator" style="color:rgb(212, 212, 212)">-&gt;</span><span class="token plain"> Expr</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">t </span><span class="token operator" style="color:rgb(212, 212, 212)">-&gt;</span><span class="token plain"> vt</span></div></code></pre></div><p>Also, <code>setVar</code> is defined in terms of <code>setStore</code> and <code>getStore</code> directly by the interpreter:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-ocaml codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">let</span><span class="token plain"> update</span><span class="token punctuation" style="color:rgb(212, 212, 212)">_</span><span class="token plain">store </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">state </span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> State</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">t</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">x </span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> string</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">v </span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Val</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">t</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> State</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">t </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">let</span><span class="token plain"> store </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> State</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(212, 212, 212)">_</span><span class="token plain">store state </span><span class="token keyword" style="color:rgb(86, 156, 214)">in</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">let</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">_</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Store</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">put store x v </span><span class="token keyword" style="color:rgb(86, 156, 214)">in</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">let</span><span class="token plain"> state&#x27; </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> State</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">set</span><span class="token punctuation" style="color:rgb(212, 212, 212)">_</span><span class="token plain">store state store </span><span class="token keyword" style="color:rgb(86, 156, 214)">in</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    state&#x27;</span></div></code></pre></div><p>Note that variables are treated as strings. Also note the usage of <code>Store.put</code>: stores have their own interface in the implementation, simplifying their usage.</p><p>The <code>execute_action</code> function defined in the state interface corresponds to the lifting of user-defined memory-model actions, as in line 212.</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-ocaml codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">val</span><span class="token plain"> execute</span><span class="token punctuation" style="color:rgb(212, 212, 212)">_</span><span class="token plain">action </span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> string </span><span class="token operator" style="color:rgb(212, 212, 212)">-&gt;</span><span class="token plain"> t </span><span class="token operator" style="color:rgb(212, 212, 212)">-&gt;</span><span class="token plain"> vt list </span><span class="token operator" style="color:rgb(212, 212, 212)">-&gt;</span><span class="token plain"> action</span><span class="token punctuation" style="color:rgb(212, 212, 212)">_</span><span class="token plain">ret</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">type</span><span class="token plain"> action</span><span class="token punctuation" style="color:rgb(212, 212, 212)">_</span><span class="token plain">ret </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> ASucc </span><span class="token keyword" style="color:rgb(86, 156, 214)">of</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">t </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> vt list</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> AFail </span><span class="token keyword" style="color:rgb(86, 156, 214)">of</span><span class="token plain"> err</span><span class="token punctuation" style="color:rgb(212, 212, 212)">_</span><span class="token plain">t list</span></div></code></pre></div><p>Note that, as above, actions are represented as strings. Action execution returns either a list of successful outcomes (pairs of states and lists of returned values) or error information, in case of failure. This error information is useful for automatic compositional testing.</p><p>Finally, the implemented state interface exposes many other functions important for the analysis. Some of them are used by the symbolic testing, but would only clutter the presentation, such as <code>assume_t</code> or <code>get_lvars</code>; others, such as <code>unify_assertion</code>, <code>produce_posts</code>, and <code>apply_fixes</code>, are useful either for the verification mode or the automatic compositional testing mode of Gillian, and are out of scope for this paper.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="the-memory-interfaces"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#the-memory-interfaces" title="Direct link to heading">#</a>The Memory Interfaces</h3><p>The concrete and symbolic memory models are defined in the paper in lines 410 and 415, respectively.</p><p>In the implementation, their interfaces, found in <a href="https://github.com/GillianPlatform/Gillian/blob/PLDI20/GillianCore/engine/ConcreteSemantics/CMemory.ml"><code>CMemory.ml</code></a> and <a href="https://github.com/GillianPlatform/Gillian/blob/PLDI20/GillianCore/engine/SymbolicSemantics/SState.ml"><code>SMemory.ml</code></a>, expose additional functionalities.</p><p>As the paper states, the interfaces expose the following:</p><ul><li>the type <code>t</code>, the type of memories, which correspond, respectively, to <em>M</em> and <em>\hat M</em> in the paper.</li><li>the function <code>execute_action: string -&gt; t -&gt; vt list -&gt; action_ret</code> for the concrete memory models, which corresponds to the theoretical definition apart from the fact that actions are represented as strings and that concrete actions can return an error, then reported or used for automatic compositional testing (out of scope)</li><li>the function <code>val execute_action: string -&gt; t -&gt; PFS.t -&gt; TypeEnv.t -&gt; vt list -&gt; action_ret</code> for the symbolic memory models, which correspond to the theoretical definition apart from the fact that actions that are represented as strings, that they can return errors, and that the path conditions are split into two parts: pure formulae, <code>PFS.t</code>; and typing environments, <code>TypeEnv.t</code>.</li></ul><p>Additionally, since the memories may be mutable (for efficiency), the users must also define an <code>init</code> function and a <code>copy</code> function.
For debugging purpose, they are also required to provide pretty-printers for their memory.</p><p>Finally, there are a lot of definitions (<code>ga_to_...</code>, <code>is_overlaping_asrt</code>, <code>assertions</code>, <code>mem_constraints</code>, <code>type err_t</code>, etc.) that are used either for verification or automatic compositional testing and are out of scope of this paper.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="references"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#references" title="Direct link to heading">#</a>References</h1><ul><li><strong>[JaVerT]</strong> José Fragoso Santos, Petar Maksimović, Daiva Naudžiūnienė, Thomas Wood, Philippa Gardner: JaVerT: JavaScript Verification Toolchain. PACMPL 2(POPL): 50:1-50:33 (2018)</li><li><strong>[Cosette]</strong> José Fragoso Santos, Petar Maksimović, Théotime Grohens, Julian Dolby, Philippa Gardner: Symbolic Execution for JavaScript. PPDP 2018: 11:1-11:14</li><li><strong>[JaVerT 2.0]</strong> José Fragoso Santos, Petar Maksimović, Gabriela Sampaio, Philippa Gardner: JaVerT 2.0: Compositional Symbolic Execution for JavaScript. PACMPL 3(POPL): 66:1-66:31 (2019)</li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/GillianPlatform/GillianPlatform.github.io/edit/source/docs/artifact.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="contents contents__left-border"><li><a href="#downloading-and-starting-up-the-vm" class="contents__link">Downloading and starting up the VM</a></li><li><a href="#basic-testing" class="contents__link">Basic testing</a><ul><li><a href="#rebuilding-gillian" class="contents__link">Rebuilding Gillian</a></li><li><a href="#testing-gillian-js-against-a-bit-of-the-test262-official-javascript-test-suite" class="contents__link">Testing Gillian-JS against a bit of the Test262 official JavaScript test suite</a></li><li><a href="#symbolically-testing-a-part-of-bucketsjs-using-gillian-js" class="contents__link">Symbolically testing a part of Buckets.js using Gillian-JS</a></li><li><a href="#symbolically-testing-a-part-of-collections-c-using-gillian-c" class="contents__link">Symbolically testing a part of Collections-C using Gillian-C</a></li></ul></li><li><a href="#gillian-js-section-41" class="contents__link">Gillian-JS (Section 4.1)</a><ul><li><a href="#coverage-of-js-2-gil" class="contents__link">Coverage of JS-2-GIL</a></li><li><a href="#correctness-of-js-2-gil" class="contents__link">Correctness of JS-2-GIL</a></li><li><a href="#writing-symbolic-tests" class="contents__link">Writing Symbolic Tests</a></li><li><a href="#symbolic-testing-of-bucketsjs" class="contents__link">Symbolic Testing of Buckets.js</a></li><li><a href="#reproducing-the-bucketsjs-bugs-found-by-cosette-and-javert-20" class="contents__link">Reproducing the Buckets.js Bugs found by Cosette and JaVerT 2.0</a></li><li><a href="#cosette-multi-dictionary-bug" class="contents__link">Cosette Multi-Dictionary Bug</a></li><li><a href="#javert-20-linked-list-bugs" class="contents__link">JaVerT 2.0 Linked-List Bugs</a></li></ul></li><li><a href="#gillian-c-section-42" class="contents__link">Gillian-C (Section 4.2)</a><ul><li><a href="#writing-symbolic-tests-1" class="contents__link">Writing Symbolic Tests</a></li><li><a href="#symbolic-testing-of-collections-c" class="contents__link">Symbolic Testing of Collections-C</a></li></ul></li><li><a href="#from-theory-to-implementation" class="contents__link">From Theory to Implementation</a><ul><li><a href="#gil-syntax-and-semantics" class="contents__link">GIL Syntax and Semantics</a></li><li><a href="#allocators" class="contents__link">Allocators</a></li><li><a href="#the-state-model-interface" class="contents__link">The State Model interface</a></li><li><a href="#the-memory-interfaces" class="contents__link">The Memory Interfaces</a></li></ul></li></ul></div></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/doc1">Style Guide</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/doc2">Second Doc</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Resources</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/tutorial">Tutorial</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://github.com/GillianPlatform/Gillian">GitHub</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="docs/js/references">references</a></li></ul></div></div><div class="text--center"><div>Copyright © 2020 Gillian Team. Gillian and WISL logos by Valentin Magnat. Built with Docusaurus.</div></div></div></footer>
</div>

<script src="/styles.6ee02291.js"></script>

<script src="/runtime~main.f9559c41.js"></script>

<script src="/main.88bc4ab7.js"></script>

<script src="/1.2e06b5bd.js"></script>

<script src="/2.891776eb.js"></script>

<script src="/29.e21bd2d3.js"></script>

<script src="/20ac7829.f548c11f.js"></script>

<script src="/17896441.18bb5f40.js"></script>

<script src="/20d095a8.2c797393.js"></script>


</body>
</html>