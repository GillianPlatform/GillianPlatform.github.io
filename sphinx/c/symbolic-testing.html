<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Gillian-JS" href="../js/index.html" /><link rel="prev" title="Folder Structure" href="folder-structure.html" />

    <link rel="shortcut icon" href="../_static/favicon.ico"/><!-- Generated with Sphinx 7.2.5 and Furo 2023.09.10 -->
        <title>Symbolic Testing - Gillian master (8306c3c ) (2023/09/12 15:24) documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d8449d71" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/css/fixes.css?v=93dd3e4f" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #ffffff;
  --color-code-foreground: black;
  --color-brand-primary: #b5393a;
  --color-brand-content: #437d89;
  --color-code-background: hsl(210deg, 2%, 68%, 0.0625);
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #e9494b;
  --color-brand-content: #5dacbc;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #e9494b;
  --color-brand-content: #5dacbc;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Gillian master
 (8306c3c
) (2023/09/12 15:24) documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/img/logo_light.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/img/logo_dark.svg" alt="Dark Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop.html">Developing Gillian</a></li>
<li class="toctree-l1"><a class="reference internal" href="../debugger.html">The Gillian Debugger</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Instantiations</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Gillian-C</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Gillian-C</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="folder-structure.html">Folder Structure</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Symbolic Testing</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../js/index.html">Gillian-JS</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Gillian-JS</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../js/folder-structure.html">Folder Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js/js2gil.html">JS-2-GIL and Test262</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js/symbolic-testing.html">Symbolic Testing</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About Gillian</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../publications/index.html">Publications</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Publications</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../publications/javert.html">JaVerT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../publications/cosette.html">Cosette</a></li>
<li class="toctree-l2"><a class="reference internal" href="../publications/javert-2.html">JaVerT 2.0</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../publications/gillian-part-1.html">Gillian, Part I</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Gillian, Part I</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../publications/gillian-part-1-diff.html">Differences between Paper and Implementation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../publications/gillian-part-2.html">Gillian, Part II</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">Copyright and License</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="symbolic-testing">
<h1>Symbolic Testing<a class="headerlink" href="#symbolic-testing" title="Link to this heading">#</a></h1>
<section id="writing-symbolic-tests">
<h2>Writing Symbolic Tests<a class="headerlink" href="#writing-symbolic-tests" title="Link to this heading">#</a></h2>
<p>The whole-program symbolic testing aspect of Gillian-C works in a close way to <a class="reference external" href="https://klee.github.io">Klee</a>’s.</p>
<section id="declaring-symbolic-variables">
<h3>Declaring Symbolic Variables<a class="headerlink" href="#declaring-symbolic-variables" title="Link to this heading">#</a></h3>
<p>In order to declare symbolic variables, we hijack the <code class="docutils literal notranslate"><span class="pre">__builtin_annot_intval</span></code> function of CompCert. An symbolic integer is declared in the following way:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__builtin_annot_intval</span><span class="p">(</span><span class="s">&quot;symb_int&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
<p>As Gillian-C is in its very early stage, it is impossible to declare variables that have undefined size in memory.</p>
<p>It is possible to declare a symbolic string of fixed size by declaring all of its components one by one. For example, for a string that contains one character:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__builtin_annot_intval</span><span class="p">(</span><span class="s">&quot;symb_int&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">);</span>
<span class="n">ASSUME</span><span class="p">(</span><span class="mi">-128</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p">);</span><span class="n">ASSUME</span><span class="p">(</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">127</span><span class="p">);</span>
<span class="kt">char</span><span class="w"> </span><span class="n">c_a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="kt">char</span><span class="w"> </span><span class="n">str_a</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">c_a</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="w"> </span><span class="p">};</span>
</pre></div>
</div>
</section>
<section id="assumptions-and-assertions">
<h3>Assumptions and Assertions<a class="headerlink" href="#assumptions-and-assertions" title="Link to this heading">#</a></h3>
<p>For any <code class="docutils literal notranslate"><span class="pre">C</span></code> boolean expression <code class="docutils literal notranslate"><span class="pre">e</span></code>, it is possible to write:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">ASSUME</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
<span class="n">ASSERT</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
</pre></div>
</div>
<p>The expression <code class="docutils literal notranslate"><span class="pre">e</span></code> is compiled to commands (since C expressions can have side-effects but GIL expressions cannot).
Then, a final GIL expression will contain a “serialised C integer” (since <code class="docutils literal notranslate"><span class="pre">C</span></code> booleans are actually integers that have value 0 or 1).
A serialized C integer is a list of the form <code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">&quot;int&quot;,</span> <span class="pre">x</span> <span class="pre">}}</span></code> where <code class="docutils literal notranslate"><span class="pre">x</span></code> is a GIL number.
<code class="docutils literal notranslate"><span class="pre">ASSUME</span></code> will call the internal GIL <code class="docutils literal notranslate"><span class="pre">assume</span></code> in the form <code class="docutils literal notranslate"><span class="pre">assume(e</span> <span class="pre">=</span> <span class="pre">{{</span> <span class="pre">&quot;int&quot;,</span> <span class="pre">1</span> <span class="pre">}})</span></code> which means “check that the obtained boolean expression is True”, otherwise, cut the branch.
<code class="docutils literal notranslate"><span class="pre">ASSERT</span></code> does the same as assume but calls the internal GIL <code class="docutils literal notranslate"><span class="pre">assert</span></code> instead.</p>
<p>As opposed to <a class="reference external" href="../JavaScript/stest#assumptions-and-assertions">Gillian-JS</a>, we use C expressions directly, and not custom expressions. This benefits is that one does not have to learn a new syntax for writing tests. However, this causes the execution to branch a lot for. <code class="docutils literal notranslate"><span class="pre">ASSUME</span></code> will then cut any branch that we do not want. In Gillian-JS, given the complex control flow of JavaScript, there is a lot more branching happening, which can become quite difficult to handle. Also, in JavaScript, the very complex semantics of expressions can lead to behaviours that are not desired by the used, and providing a simpler expression syntax is more straightforward.</p>
</section>
</section>
<section id="symbolic-testing-of-collections-c">
<h2>Symbolic Testing of Collections-C<a class="headerlink" href="#symbolic-testing-of-collections-c" title="Link to this heading">#</a></h2>
<section id="fixes">
<h3>Fixes<a class="headerlink" href="#fixes" title="Link to this heading">#</a></h3>
<p>Symbolically testing Collections-C let to the following bug-fixing pull requests. They fix previously unknown bugs and usage of undefined behaviours:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/srdja/Collections-C/pull/119">Fix buffer overflow</a> (bug)</p></li>
<li><p><a class="reference external" href="https://github.com/srdja/Collections-C/pull/122">Remove the usage of cc_comp_ptr</a> (undefined behaviour)</p></li>
<li><p><a class="reference external" href="https://github.com/srdja/Collections-C/pull/123">Test coincidentally passing while they should not</a> (bugs and undefined behaviours)</p></li>
<li><p><a class="reference external" href="https://github.com/srdja/Collections-C/pull/125">Fix overallocation</a> (bug)</p></li>
<li><p><a class="reference external" href="https://github.com/srdja/Collections-C/pull/126">Fix hashing function</a> (performance-reducing bug)</p></li>
</ul>
</section>
<section id="reproducing-the-results">
<h3>Reproducing the Results<a class="headerlink" href="#reproducing-the-results" title="Link to this heading">#</a></h3>
<p>For license reason, we do not include the Collections-C code in the Gillian repository.
There is an <a class="reference external" href="https://github.com/GillianPlatform/collections-c-for-gillian">external repository</a> that contains the Collections-C code adapted to testing in Gillian-C and Klee.</p>
<p>In order to clone it, simply run, from the Gillian folder:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>..
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/GillianPlatform/collections-c-for-gillian.git<span class="w"> </span>collection-
<span class="nb">cd</span><span class="w"> </span>Gillian
</pre></div>
</div>
<p>There are two ways of launching the tests:</p>
<ul class="simple">
<li><p>Using the <code class="docutils literal notranslate"><span class="pre">bulk-wpst</span></code> command of Gillian-C which has a nicer output (using Rely), but cannot run the tests in parallel.</p></li>
<li><p>Using a bash script that will call <code class="docutils literal notranslate"><span class="pre">gillian-c</span> <span class="pre">wpst</span></code> as many times as there are files to test, but supports parallel mode (this is the one we used for measures). (NOTE: since then, we removed the option for parallel mode, and plan of having a better implementation in the future)</p></li>
</ul>
<section id="using-bulk-wpst">
<h4>Using bulk-wpst<a class="headerlink" href="#using-bulk-wpst" title="Link to this heading">#</a></h4>
<p>From the Gillian folder run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>esy<span class="w"> </span>x<span class="w"> </span>gillian-c<span class="w"> </span>bulk-wpst<span class="w"> </span>../collections-c/for-gillian
</pre></div>
</div>
<p>You will see every test suites executing one by one. Two tests will fail, this is intended. They represent two of the bugs we’ve found and are explained <a class="reference external" href="#bug-tests">here</a>.</p>
</section>
<section id="using-the-bash-script">
<h4>Using the bash script<a class="headerlink" href="#using-the-bash-script" title="Link to this heading">#</a></h4>
<p>From the Gillian folder, for each folder you want to test, use:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Gillian-C/scripts/testFolder.sh<span class="w"> </span>../collections-c/for-gillian/folder
</pre></div>
</div>
<p>For example, to run the test suite related to singly-linked lists, run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Gillian-C/scripts/testFolder.sh<span class="w"> </span>../collections-c/for-gillian/slist
</pre></div>
</div>
</section>
</section>
<section id="the-array-test-remove-c-buffer-overflow-bug">
<h3>The <code class="docutils literal notranslate"><span class="pre">array_test_remove.c</span></code> buffer overflow bug<a class="headerlink" href="#the-array-test-remove-c-buffer-overflow-bug" title="Link to this heading">#</a></h3>
<p>This test corresponds to this pull request: <a class="reference external" href="https://github.com/srdja/Collections-C/pull/119">Fix buffer overflow</a>.
It is particularly interesting: the original test suite did not catch it. We thought that a concrete test with the right values would catch it, but it didn’t. The reason is that it overflowed but did not fail. It is therefore a <em>security issue</em>. However, our symbolic memory model cannot overflow, and the bug was caught.</p>
</section>
<section id="the-list-test-zipiteradd-c-flawed-test">
<h3>The <code class="docutils literal notranslate"><span class="pre">list_test_zipIterAdd.c</span></code> flawed test<a class="headerlink" href="#the-list-test-zipiteradd-c-flawed-test" title="Link to this heading">#</a></h3>
<p>This test is also interesting but for different reasons. The code it is testing (the <code class="docutils literal notranslate"><span class="pre">list_zip_iter_add</span></code> function) does not contain any bug.
However, the test itself did contain a bug but still passed. Here is why:</p>
<p>The test added two elements (<code class="docutils literal notranslate"><span class="pre">&quot;h&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;i&quot;</span></code>) in two separate lists at the index 2. It then tested that the elements actually appeared at the second index of their respective lists, in the following way:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">list_index_of</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;h&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">zero_if_ptr_eq</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">index</span><span class="p">);</span>
<span class="n">CHECK_EQUAL_C_INT</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">);</span>

<span class="n">list_index_of</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;i&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">zero_if_ptr_eq</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">index</span><span class="p">);</span>
<span class="n">CHECK_EQUAL_C_INT</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">);</span>
</pre></div>
</div>
<p>However, note that both tests are executed on <code class="docutils literal notranslate"><span class="pre">list1</span></code>! What happened then is that <code class="docutils literal notranslate"><span class="pre">list_index_of</span></code> was not finding <code class="docutils literal notranslate"><span class="pre">&quot;i&quot;</span></code> in <code class="docutils literal notranslate"><span class="pre">list1</span></code> because it wasn’t there, and therefore did not modify <code class="docutils literal notranslate"><span class="pre">index</span></code>. Since the first check was correct, the value of <code class="docutils literal notranslate"><span class="pre">index</span></code> was still <code class="docutils literal notranslate"><span class="pre">2</span></code> and the test passed anyway.</p>
<p>Our symbolic tests however, use symbolic 1-character strings, and assume <strong>the bare minimum about the input values</strong> to make them pass, in order to explore as many possible paths as possible.</p>
<p>Here, we replaced every one-character strings <code class="docutils literal notranslate"><span class="pre">&quot;X&quot;</span></code> with one-character symbolic string <code class="docutils literal notranslate"><span class="pre">str_X</span></code>. For the test to pass, it should be <em>enough</em> for <code class="docutils literal notranslate"><span class="pre">str_h</span></code> to be different from every element in <code class="docutils literal notranslate"><span class="pre">list1</span></code> and for <code class="docutils literal notranslate"><span class="pre">str_i</span></code> to be different from every element in <code class="docutils literal notranslate"><span class="pre">list2</span></code>. And this is exactly what we assumed. However, we never assume that <code class="docutils literal notranslate"><span class="pre">str_i</span></code> has to be different from every element in <code class="docutils literal notranslate"><span class="pre">list1</span></code> because it is not necessary for the test to pass.</p>
<p>However, here, the equality between every element of <code class="docutils literal notranslate"><span class="pre">list1</span></code> and <code class="docutils literal notranslate"><span class="pre">str_i</span></code> is tested. There is no indication as to the result of this test, so the execution branches. Therefore, there is a path created where <code class="docutils literal notranslate"><span class="pre">list_index_of(list1,</span> <span class="pre">str_i,</span> <span class="pre">zero_if_ptr_eq,</span> <span class="pre">&amp;index)</span></code> will assign <code class="docutils literal notranslate"><span class="pre">0</span></code> to index, and the test will fail.</p>
<p>This shows how symbolic testing helps writing <em>more robust</em> tests.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../js/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Gillian-JS</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="folder-structure.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Folder Structure</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; Gillian Team @ Imperial College London
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Symbolic Testing</a><ul>
<li><a class="reference internal" href="#writing-symbolic-tests">Writing Symbolic Tests</a><ul>
<li><a class="reference internal" href="#declaring-symbolic-variables">Declaring Symbolic Variables</a></li>
<li><a class="reference internal" href="#assumptions-and-assertions">Assumptions and Assertions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#symbolic-testing-of-collections-c">Symbolic Testing of Collections-C</a><ul>
<li><a class="reference internal" href="#fixes">Fixes</a></li>
<li><a class="reference internal" href="#reproducing-the-results">Reproducing the Results</a><ul>
<li><a class="reference internal" href="#using-bulk-wpst">Using bulk-wpst</a></li>
<li><a class="reference internal" href="#using-the-bash-script">Using the bash script</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-array-test-remove-c-buffer-overflow-bug">The <code class="docutils literal notranslate"><span class="pre">array_test_remove.c</span></code> buffer overflow bug</a></li>
<li><a class="reference internal" href="#the-list-test-zipiteradd-c-flawed-test">The <code class="docutils literal notranslate"><span class="pre">list_test_zipIterAdd.c</span></code> flawed test</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=2e1361ba"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>